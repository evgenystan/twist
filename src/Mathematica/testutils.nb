(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    208594,       5407]
NotebookOptionsPosition[    208108,       5387]
NotebookOutlinePosition[    208482,       5403]
CellTagsIndexPosition[    208439,       5400]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"General", "::", "\"\<spell\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"General", "::", "\"\<spell1\>\""}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588788788730583*^9, 3.588788839322361*^9}, {
   3.5887890946756763`*^9, 3.588789114902072*^9}, 3.5887891450179243`*^9, {
   3.58878919240965*^9, 3.588789266267112*^9}, 3.588789334846941*^9, {
   3.588789448921554*^9, 3.588789502475102*^9}, {3.5887895849834013`*^9, 
   3.5887895991828957`*^9}, 3.5887897735184803`*^9, {3.588792175824545*^9, 
   3.588792189330944*^9}, {3.588792277277171*^9, 3.588792332330186*^9}, 
   3.5887923631654377`*^9, {3.588792417803377*^9, 3.588792467705484*^9}, {
   3.588792501791564*^9, 3.5887925318884897`*^9}, {3.588792583881175*^9, 
   3.5887925915934677`*^9}, {3.588792674781343*^9, 3.588792704184026*^9}, 
   3.588792764313629*^9, 3.58880617665129*^9}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "tFq", "]"}]], "Input",
 CellChangeTimes->{{3.588875339867338*^9, 3.588875346656268*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"STATEMENT", " ", "=", " ", "\"\<0\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FREERESPONSE", " ", "=", " ", "\"\<1\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MULTIPLECHOICE", " ", "=", " ", "\"\<2\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588788788730583*^9, 3.588788839322361*^9}, {
   3.5887890946756763`*^9, 3.588789114902072*^9}, 3.5887891450179243`*^9, {
   3.58878919240965*^9, 3.588789266267112*^9}, 3.588789334846941*^9, {
   3.588789448921554*^9, 3.588789502475102*^9}, {3.5887895849834013`*^9, 
   3.5887895991828957`*^9}, 3.5887897735184803`*^9, {3.588792175824545*^9, 
   3.588792189330944*^9}, {3.588792277277171*^9, 3.588792332330186*^9}, 
   3.5887923631654377`*^9, {3.588792417803377*^9, 3.588792467705484*^9}, {
   3.588792501791564*^9, 3.5887925318884897`*^9}, {3.588792583881175*^9, 
   3.5887925915934677`*^9}, {3.588792674781343*^9, 3.588792704184026*^9}, 
   3.588792764313629*^9, {3.58880617665129*^9, 3.588806216622615*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Plot", ",", 
    RowBox[{"BaseStyle", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Chalkboard\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontColor", "\[Rule]", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0", ",", "0", ",", "0"}], "]"}]}]}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"ListPlot", ",", 
     RowBox[{"BaseStyle", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Chalkboard\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
        RowBox[{"FontColor", "\[Rule]", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0", ",", "0", ",", "0"}], "]"}]}]}], "}"}]}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "\[IndentingNewLine]", " ", 
   RowBox[{
   "The", " ", "following", " ", "should", " ", "be", " ", "set", " ", "in", 
    " ", "frontend", " ", "init", " ", "file"}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", " ", 
   RowBox[{
    RowBox[{"$FrontEnd", "\[NotEqual]", "Null"}], ",", " ", 
    RowBox[{"SetOptions", "[", 
     RowBox[{"$FrontEnd", ",", " ", 
      RowBox[{"NumberMultiplier", "\[Rule]", "\"\<\[Cross]\>\""}]}], "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"PaddedForm", ",", 
    RowBox[{"NumberMultiplier", "\[Rule]", "\"\<\[Cross]\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"NumberForm", ",", 
    RowBox[{"NumberMultiplier", "\[Rule]", "\"\<\[Cross]\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ScientificForm", ",", 
    RowBox[{"NumberMultiplier", "\[Rule]", "\"\<\[Cross]\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"EngineeringForm", ",", 
    RowBox[{"NumberMultiplier", "\[Rule]", "\"\<\[Cross]\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"AccountingForm", ",", 
     RowBox[{"NumberMultiplier", "\[Rule]", "\"\<\[Cross]\>\""}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", "used", " ", "to", " ", "control", " ", "parenthesis", " ", 
    "printing", " ", "in", " ", "logs"}], "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "Log", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"Log", "[", 
     RowBox[{"dummy", "[", "x_", "]"}], "]"}], "]"}], ":=", 
   RowBox[{"Log", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Protect", "[", "Log", "]"}], ";"}], "\n", 
  RowBox[{"(*", "*******************************)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numberJoin", "[", 
    RowBox[{
     RowBox[{"x_", "?", "NumberQ"}], ",", 
     RowBox[{"y_", "?", "NumberQ"}]}], "]"}], ":=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{
     RowBox[{"ToString", "[", "x", "]"}], "<>", 
     RowBox[{"ToString", "[", "y", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"numberJoin", "[", 
     RowBox[{
      RowBox[{"x_", "?", "NumberQ"}], ",", 
      RowBox[{"y_", "?", "NumberQ"}], ",", "z__"}], "]"}], ":=", 
    RowBox[{"numberJoin", "[", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "x", "]"}], "<>", 
        RowBox[{"ToString", "[", "y", "]"}]}], "]"}], ",", "z"}], "]"}]}], 
   ";", 
   RowBox[{"SetAttributes", "[", 
    RowBox[{"numberJoin", ",", "Listable"}], "]"}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"**", "**", "**", "**"}], 
   "******************************************)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Complex", " ", "variable", " ", "and", " ", "function", " ", 
    "utilities"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cC", "[", "z_", "]"}], ":=", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"z", ",", 
     RowBox[{
      RowBox[{"Complex", "[", 
       RowBox[{"mvar_", ",", "nvar_"}], "]"}], "\[Rule]", 
      RowBox[{"Complex", "[", 
       RowBox[{"mvar", ",", 
        RowBox[{"-", "nvar"}]}], "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rePart", "[", "z_", "]"}], ":=", 
   RowBox[{"ComplexExpand", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"z", "+", 
       RowBox[{"cC", "[", "z", "]"}]}], ")"}], "/", "2"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"imPart", "[", "z_", "]"}], ":=", 
    RowBox[{"ComplexExpand", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"z", "-", 
         RowBox[{"cC", "[", "z", "]"}]}], ")"}], "/", "2"}], "/", "I"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cpx", "=", 
    RowBox[{
     RowBox[{"#", ".", 
      RowBox[{"{", 
       RowBox[{"1", ",", "I"}], "}"}]}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"const", "=", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"capitalC", ",", "#"}], "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Formats", " ", "answers", " ", "into", " ", "proper", " ", "form", " ", 
      
      RowBox[{"Usage", ":", 
       RowBox[{"Let", " ", "w"}]}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"correct", " ", "answer"}], ",", 
         RowBox[{"wrong", " ", "answer"}], ",", 
         RowBox[{"...", "."}]}], "}"}], " ", 
       RowBox[{"ProblemText", "[", "str", "]"}]}], "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Problem\>\"", ",", 
            RowBox[{"{", "...", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Comment\>\"", ",", 
            RowBox[{"{", "...", "}"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"answers", "[", "w", "]"}]}], "]"}]}]}], ";"}], "*)"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ansLabels", "[", "nw_", "]"}], ":=", 
    RowBox[{"Nest", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", "\"\<Wrong\>\"", "}"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", "\"\<Right\>\"", "}"}], ",", "nw"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"buildAns", ":=", 
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#1", ",", 
          RowBox[{"{", "#2", "}"}]}], "}"}], "&"}], ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"#1", ",", "#2"}], "}"}], "]"}], ",", 
       RowBox[{"{", "1", "}"}]}], "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"answers", "=", 
    RowBox[{
     RowBox[{"buildAns", "[", 
      RowBox[{
       RowBox[{"ansLabels", "[", 
        RowBox[{
         RowBox[{"Length", "[", "#1", "]"}], "-", "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"Head", "[", "#1", "]"}], ",", "String"}], "]"}], "||", 
             RowBox[{"gQ", "[", "#", "]"}]}], ",", "#1", ",", 
            RowBox[{"tFq", "[", "#1", "]"}]}], "]"}], ")"}], "&"}], "/@", 
        "#1"}]}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", "Formats", " ", "numbers", " ", "as", " ", "dollars"}], 
   "***)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"money", ":=", 
    RowBox[{
     RowBox[{"tF", "[", 
      RowBox[{"NumberForm", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "#1", "]"}], ",", "#1", ",", 
          RowBox[{"N", "[", "#", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"12", ",", "2"}], "}"}], ",", 
        RowBox[{"NumberSigns", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<-$\>\"", ",", "\"\<$\>\""}], "}"}]}], ",", 
        RowBox[{"NumberPadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<\>\"", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"IntegerQ", "[", "#1", "]"}], ",", "\"\<\>\"", ",", 
             "\"\<0\>\""}], "]"}]}], "}"}]}], ",", 
        RowBox[{"NumberPoint", "\[Rule]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"IntegerQ", "[", "#1", "]"}], ",", "\"\<\>\"", ",", 
           "\"\<.\>\""}], "]"}]}], ",", 
        RowBox[{"DigitBlock", "\[Rule]", "3"}], ",", 
        RowBox[{"NumberSeparator", "\[Rule]", "\"\<,\>\""}]}], "]"}], "]"}], 
     "&"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sQ", "[", 
     RowBox[{"prob_", "?", "VectorQ"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"makeproblem", "[", 
        RowBox[{"prob", ",", "\"\<A\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"printHeader", "[", 
        RowBox[{"\"\<*****>  Problem Identifier = \>\"", "<>", 
         RowBox[{"tFq", "[", "prob", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Column", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ImportString", "[", 
           RowBox[{"#", ",", "\"\<Base64\>\""}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"makeCodedGif", "/@", 
           RowBox[{"(", 
            RowBox[{"MakeCell", "/@", 
             RowBox[{"Flatten", "[", 
              RowBox[{"ProblemText", "[", "\"\<A\>\"", "]"}], "]"}]}], 
            ")"}]}], ")"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], "\n", 
  
  RowBox[{"(*", 
   RowBox[{
   "test", " ", "if", " ", "object", " ", "is", " ", "a", " ", "graphics", 
    " ", "object"}], "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"20111009", " ", "-", " ", 
      RowBox[{"removed", " ", "Head", " ", "Grid"}]}], " ", "&"}], " ", 
    "added", " ", "3"}], "  ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gQ", "=", 
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Graphics", ",", "Image", ",", "GraphicsGrid", ",", "DensityGraphics",
          ",", "GraphicsArray", ",", "ContourGraphics", ",", "Graphics3D", 
         ",", "SurfaceGraphics", ",", "GraphicsRow", ",", "GraphicsColumn", 
         ",", "GraphicsComplex"}], "}"}], ",", 
       RowBox[{"Head", "[", "#", "]"}]}], "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "A", " ", "specialty", " ", "utility", " ", "designed", " ", "for", " ", 
    "a", " ", "particular", " ", "problem"}], "*)"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AllElmntsMoved", "[", "listin_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"listout", "=", 
         RowBox[{"{", "}"}]}], ",", "i", ",", "tf"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tf", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"Or", ",", 
          RowBox[{"Apply", "[", 
           RowBox[{"SameQ", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"listin", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "}"}], "]"}], 
               "&"}], "/@", "listin"}], ")"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "listin", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"listout", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"tf", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "listout", ",", 
            RowBox[{"Append", "[", 
             RowBox[{"listout", ",", 
              RowBox[{"listin", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", "listout"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**"}], "******)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "   ", "legacy", "    ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DistinctPairs", "[", "v_List", "]"}], ":=", 
    RowBox[{"Subsets", "[", 
     RowBox[{"v", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Domain", "[", "f", "]"}], " ", "gives", " ", "a", " ", "list", 
     " ", "of", " ", 
     RowBox[{"{", "args", "}"}], " ", "for", " ", "which", " ", 
     RowBox[{"f", "[", "args", "]"}], " ", "is", " ", 
     RowBox[{"defined", ".", "  ", "Apply"}], " ", "f", " ", "to", " ", "get",
      " ", "value"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f", "@@", 
      RowBox[{
       RowBox[{"Domain", "[", "f", "]"}], "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], " ", "returns", " ", "the", " ", 
     "value", " ", "on", " ", "jth", " ", "element", " ", "of", " ", "the", 
     " ", 
     RowBox[{"domain", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Domain", "[", "f_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ")"}], "&"}], "/@", 
     RowBox[{"DownValues", "[", "f", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"closest", "=", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ".", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}], ")"}], "/@", 
        RowBox[{"Subsets", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "]"}], "&"}]}], ";"}], 
  "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "MinDist", " ", "returns", " ", "the", " ", "distance", " ", "between", 
    " ", "the", " ", "nearest", " ", "neighbors", " ", "among", " ", "the", 
    " ", "elements", " ", "of", " ", "the", " ", "input", " ", 
    RowBox[{"list", ".", "Elements"}], " ", "are", " ", "numbers"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MinDist", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], ")"}], "/@", 
        RowBox[{"Subsets", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], ")"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Boolean", ".", " ", "Returns"}], " ", "True", " ", "if", " ", 
    "if", " ", "a", " ", "pair", " ", "of", " ", "values", " ", "are", " ", 
    "closer", " ", "together", " ", "than", " ", "5", "%", " ", "of", " ", 
    "their", " ", 
    RowBox[{"magnitude", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mD", "[", "pts_List", "]"}], " ", ":=", 
    RowBox[{"mD", "[", 
     RowBox[{"pts", ",", ".05"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mD", "[", 
     RowBox[{"pts_List", ",", "tolerance_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ctr", "=", 
        RowBox[{"Mean", "[", "pts", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Union", "[", 
           RowBox[{"Chop", "[", "pts", "]"}], "]"}], "]"}], "\[Equal]", "1"}],
         ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
        RowBox[{"Or", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{
               "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "-", 
               RowBox[{
               "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
               "]"}], "<", 
             RowBox[{"tolerance", " ", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{
                  "#1", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "-", "ctr"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{
                  "#1", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "]"}], " ", "-", "ctr"}]}], 
               "]"}]}]}], "&"}], "/@", " ", 
           RowBox[{"Subsets", "[", 
            RowBox[{"pts", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ")"}]}]}], "  ", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Remove", " ", "duplicate", " ", "elements"}], ",", 
    RowBox[{"perserving", " ", "order", " ", "of", " ", "list"}]}], "*)"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uUnion", "[", "\[ScriptL]_List", "]"}], ":=", 
   RowBox[{"DeleteDuplicates", "[", "\[ScriptL]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uUnion", "[", 
     RowBox[{"li_List", ",", "z___"}], "]"}], ":=", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Join", "[", 
      RowBox[{"li", ",", "z"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OrderedUnion", "=", "uUnion"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ChooseRandom", "[", 
      RowBox[{"list", ",", "nr"}], "]"}], " ", 
     RowBox[{"with", "'"}], 
     RowBox[{"nr", "'"}], " ", "an", " ", "Integer", " ", "returns", " ", "a",
      " ", "random", " ", "sublist", " ", 
     RowBox[{"of", "'"}], 
     RowBox[{"list", "'"}], " ", "of", " ", 
     RowBox[{"length", "'"}], 
     RowBox[{"nr", "'"}], " ", "If", " ", "nr"}], "<", 
    RowBox[{"0", " ", "is", " ", "sorted"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChooseRandom", "[", "list_List", "]"}], ":=", 
    RowBox[{"RandomSample", "[", "list", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChooseRandom", "[", 
     RowBox[{"list_", ",", "nr_Integer"}], "]"}], ":=", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "list", "]"}], "\[Equal]", "0"}], ",", 
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"nr", "\[Equal]", "0"}], ",", 
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"nr", "<", "0"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{"ChooseRandom", "[", 
        RowBox[{"list", ",", 
         RowBox[{"-", "nr"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"nr", ">", 
       RowBox[{"Length", "[", "list", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lsize", "=", 
           RowBox[{"Length", "[", "list", "]"}]}], ",", "m", ",", "n"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "=", 
          RowBox[{"QuotientRemainder", "[", 
           RowBox[{"nr", ",", "lsize"}], "]"}]}], ";", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"RandomSample", "[", "list", "]"}], ",", 
               RowBox[{"{", "m", "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
           RowBox[{"RandomSample", "[", 
            RowBox[{"list", ",", "n"}], "]"}]}], "]"}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", "True", ",", 
      RowBox[{"RandomSample", "[", 
       RowBox[{"list", ",", "nr"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ChooseRandom", "[", 
     RowBox[{"list", ",", "nr"}], "]"}], " ", 
    RowBox[{"with", "'"}], 
    RowBox[{"nr", "'"}], " ", "a", " ", "nested", " ", "list", " ", "of", " ",
     "integers", " ", "returns", " ", "a", " ", "list", " ", "in", " ", 
    "which", " ", "numbers", " ", 
    RowBox[{"in", "'"}], 
    RowBox[{"nr", "'"}], " ", "are", " ", "replaced", " ", "by", " ", "that", 
    " ", "number", " ", "of", " ", "elements", " ", 
    RowBox[{"of", "'"}], 
    RowBox[{
     RowBox[{"list", "'"}], ".", "The"}], " ", "full", " ", "collection", " ",
     "of", " ", "elements", " ", "is", " ", "a", " ", "random", " ", 
    "sublist", " ", 
    RowBox[{"of", "'"}], 
    RowBox[{
     RowBox[{"list", "'"}], ".", "When"}], " ", "an", " ", "entry", " ", "is",
     " ", "negative", " ", "the", " ", "sublist", " ", "is", " ", "sorted"}], 
   "*)"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChooseRandom", "[", 
     RowBox[{"list_", ",", "nr_List"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"IntegerQ", "/@", 
         RowBox[{"Flatten", "[", "nr", "]"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "totl", ",", "tempflat", ",", "templist", ",", "pos", ",", "usd", 
          ",", "nrpart", ",", "temppart"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"totl", "=", 
          RowBox[{"Total", "[", 
           RowBox[{"Abs", "/@", 
            RowBox[{"Flatten", "[", "nr", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempflat", "=", 
          RowBox[{"ChooseRandom", "[", 
           RowBox[{"list", ",", "totl"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"templist", "=", "nr"}], ";", "\[IndentingNewLine]", 
         RowBox[{"pos", "=", 
          RowBox[{"Reverse", "[", 
           RowBox[{"Position", "[", 
            RowBox[{"nr", ",", "_Integer"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"usd", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"nrpart", "=", 
              RowBox[{"Extract", "[", 
               RowBox[{"nr", ",", "#"}], "]"}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{"temppart", "=", 
              RowBox[{"Take", "[", 
               RowBox[{"tempflat", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"usd", "+", "1"}], ",", 
                  RowBox[{"usd", "+", 
                   RowBox[{"Abs", "[", "nrpart", "]"}]}]}], "}"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"usd", "=", 
              RowBox[{"usd", "+", 
               RowBox[{"Abs", "[", "nrpart", "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"nrpart", "<", "0"}], ",", 
               RowBox[{"temppart", "=", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"Sort", "[", "temppart", "]"}], "]"}]}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"templist", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nrpart", "\[Equal]", "0"}], ",", 
                RowBox[{"Delete", "[", 
                 RowBox[{"templist", ",", "#"}], "]"}], ",", 
                RowBox[{"ReplacePart", "[", 
                 RowBox[{"templist", ",", 
                  RowBox[{"temppart", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{"templist", "=", 
                RowBox[{"Insert", "[", 
                 RowBox[{"templist", ",", 
                  RowBox[{"temppart", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "#"}], 
                 "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "temppart", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}]}], ")"}], "&"}], "/@", "pos"}], ";", 
         "\[IndentingNewLine]", "templist"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], "\n", 
  
  RowBox[{"(*", 
   RowBox[{
   "PowerSet", " ", "returns", " ", "the", " ", "power", " ", "set", " ", 
    "of", " ", "the", " ", "given", " ", 
    RowBox[{"list", ".", " ", "Elements"}], " ", "of", " ", "the", " ", 
    "list", " ", "are", " ", "treated", " ", "as", " ", 
    RowBox[{"distinct", ".", "  ", "Nest"}], " ", "Union", " ", "inside", " ",
     "if", " ", "that", " ", "is", " ", "not", " ", 
    RowBox[{"desired", "."}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PowerSet", "=", "Subsets"}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"RandomSign", " ", "returns"}], "+", 
    RowBox[{
     RowBox[{"/", 
      RowBox[{"-", "1"}]}], " ", "with", " ", "equal", " ", "probability"}]}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomSign", "[", "]"}], ":=", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"RandomInteger", "[", "]"}]}], "-", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"randSign", "=", 
   RowBox[{"rSign", "=", "RandomSign"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rspin", ":=", 
    RowBox[{"RandomSign", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomBoolean", "[", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"RandomInteger", "[", "]"}], "\[Equal]", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"randBoolean", "=", 
   RowBox[{"rBool", "=", "RandomBoolean"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rB", ":=", " ", 
    RowBox[{
     RowBox[{"RandomInteger", "[", "]"}], "\[Equal]", "0"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "sf", " ", "rounds", " ", "the", " ", "argument", " ", "x", " ", "to", 
     " ", "n", " ", "significant", " ", "figures", " ", "for", " ", 
     "presentation", " ", "\[IndentingNewLine]", "If", " ", "n", " ", "is", 
     " ", "not", " ", "given"}], ",", " ", 
    RowBox[{
    "3", " ", "significant", " ", "figures", " ", "are", " ", "returned"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"sf", ",", "Listable"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sf", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"sf", "[", 
    RowBox[{"x", ",", " ", "3"}], "]"}]}], "\[IndentingNewLine]", 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sf", "[", 
     RowBox[{"xx_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d", ",", "m", ",", "t", ",", "x"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"NumericQ", "[", "xx", "]"}]}], ",", " ", 
         RowBox[{"Return", "[", "xx", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "xx", "]"}], " ", "==", " ", "Complex"}], ",", 
         
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"sf", "[", 
            RowBox[{
             RowBox[{"Re", "[", "xx", "]"}], ",", " ", "n"}], "]"}], " ", "+",
            " ", 
           RowBox[{"I", "*", 
            RowBox[{"sf", "[", 
             RowBox[{
              RowBox[{"Im", "[", "xx", "]"}], ",", " ", "n"}], "]"}]}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"x", "=", 
        RowBox[{"Chop", "[", "xx", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "m"}], "}"}], "=", 
        RowBox[{"RealDigits", "[", 
         RowBox[{
          RowBox[{"N", "[", "xx", "]"}], ",", "10", ",", 
          RowBox[{"n", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"t", "[", 
            RowBox[{"[", 
             RowBox[{"n", "+", "1"}], "]"}], "]"}], "<", "5"}], ",", 
          RowBox[{"FromDigits", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"t", ",", "n"}], "]"}], ",", "m"}], "}"}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"FromDigits", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"n", "-", "1"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"t", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], "+", "1"}], "}"}]}], "]"}], 
             ",", "m"}], "}"}], "]"}]}], "  ", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Sign", "[", "xx", "]"}], " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "d", "]"}], ",", "d", ",", 
          RowBox[{"N", "[", "d", "]"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StringReplaceRepeated", "[", 
     RowBox[{"s_String", ",", "rules___"}], "]"}], ":=", 
    RowBox[{"FixedPoint", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringReplace", "[", 
        RowBox[{"#", ",", "rules"}], "]"}], "&"}], ",", "s"}], "]"}]}], ";"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Simple", " ", "shortcuts", " ", "to", " ", "put", " ", "an", " ", 
    "expression", " ", "or", " ", "equation", " ", "into", " ", "a", " ", 
    "traditional", " ", "form", " ", "string"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tF", "[", "aA_", "]"}], ":=", 
    RowBox[{"\"\<<script type='math/tex'>\>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"aA", ",", "TraditionalForm"}], "]"}], ",", "TeXForm"}], 
      "]"}], "<>", "\"\<</script>\>\""}]}], ";"}], "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "TeXForm", " ", "should", " ", "handle", " ", "matrices", " ", 
      "correctly", " ", "additional", " ", "processing", " ", "will", " ", 
      "be", " ", "required", "\[IndentingNewLine]", 
      RowBox[{"tF", "[", 
       RowBox[{"a_", "?", "MatrixQ"}], "]"}]}], ":=", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"tF", "[", 
        RowBox[{"mdummy", "[", 
         RowBox[{"TableForm", "[", 
          RowBox[{"a", ",", 
           RowBox[{"TableSpacing", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"2", ",", "2"}], "}"}]}], ",", 
           RowBox[{"TableAlignments", "\[Rule]", "Right"}]}], "]"}], "]"}], 
        "]"}], ",", 
       RowBox[{"\"\<mdummy\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Transform", " ", "a", " ", "Mathematica", " ", "expression", " ", "into", 
    " ", "a", " ", "LaTeX", " ", 
    RowBox[{"string", ".", " ", "A"}], " ", "few", " ", "helpful", " ", 
    "substitutions", " ", "are", " ", "performed", " ", "for", " ", "a", " ", 
    "better", " ", "output"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tFq", "[", 
   RowBox[{"math_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dummy", ",", "DisplayMath"}], "}"}], ",", 
    RowBox[{"\"\<<script type='math/tex\>\"", "<>", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "DisplayMath", "]"}], ",", 
       "\"\<; mode=display\>\"", ",", "\"\<\>\""}], "]"}], "<>", "\"\<'>\>\"",
      "<>", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"math", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"dummy", "'"}], "[", "_", "]"}], "\[Rule]", "1"}]}], ",", 
         "TeXForm"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<==\>\"", "\[Rule]", "\"\<\[LongEqual]\>\""}], ",", 
         RowBox[{"\"\<\[Equal]\>\"", "\[Rule]", "\"\<\[LongEqual]\>\""}], ",", 
         RowBox[{"\"\<capitalC\>\"", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"\"\<zzone\>\"", "\[Rule]", "\"\<1\>\""}], ",", 
         RowBox[{"\"\<dummy\>\"", "\[Rule]", "\"\<\>\""}], ",", 
         RowBox[{"\"\<zdummy\>\"", "\[Rule]", "\"\<\>\""}], ",", 
         RowBox[{"\"\<log\>\"", "\[Rule]", "\"\<ln\>\""}]}], "}"}]}], "]"}], 
     "<>", "\"\<</script>\>\""}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "tFq", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"DisplayMath", "\[Rule]", "False"}], "}"}]}], ";"}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tFqa", ":=", 
    RowBox[{
     RowBox[{"\"\<<script type='math/tex'>\>\"", "<>", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"#", "/.", 
           RowBox[{
            RowBox[{
             RowBox[{"dummy", "'"}], "[", "_", "]"}], "\[Rule]", "1"}]}], ",",
           "TeXForm"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<==\>\"", "\[Rule]", "\"\<\[LongEqual]\>\""}], ",", 
          RowBox[{"\"\<\[Equal]\>\"", "\[Rule]", "\"\<\[LongEqual]\>\""}], 
          ",", 
          RowBox[{"\"\<capitalC\>\"", "\[Rule]", "\"\<C\>\""}], ",", 
          RowBox[{"\"\<zzone\>\"", "\[Rule]", "\"\<1\>\""}], ",", 
          RowBox[{"\"\<dummy\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<zdummy\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<log\>\"", "\[Rule]", "\"\<ln\>\""}], ",", 
          RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<\[LeftAngleBracket]\>\""}], 
          ",", 
          RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<\[RightAngleBracket]\>\""}]}], 
         "}"}]}], "]"}], "<>", "\"\<</script>\>\""}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tFb", ":=", 
    RowBox[{
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"tF", "[", "#1", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<[\>\""}], ",", 
         RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<]\>\""}]}], "}"}]}], "]"}], 
     "&"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tForm", "=", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "dummy", "}"}], ",", 
       RowBox[{"\"\<<script type='math/tex'>\>\"", "<>", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"#", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"dummy", "'"}], "[", "_", "]"}], "\[Rule]", "1"}]}], 
            ",", "TeXForm"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<==\>\"", "\[Rule]", "\"\<\[LongEqual]\>\""}], ",", 
            RowBox[{"\"\<\[Equal]\>\"", "\[Rule]", "\"\<\[LongEqual]\>\""}], 
            ",", 
            RowBox[{"\"\<capitalC\>\"", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"\"\<zzone\>\"", "\[Rule]", "\"\<1\>\""}], ",", 
            RowBox[{"\"\<dummy\>\"", "\[Rule]", "\"\<\>\""}], ",", 
            RowBox[{"\"\<zdummy\>\"", "\[Rule]", "\"\<\>\""}], ",", 
            RowBox[{"\"\<log\>\"", "\[Rule]", "\"\<ln\>\""}]}], "}"}]}], 
         "]"}], "<>", "\"\<</script>\>\""}]}], "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "TeXForm", " ", "should", " ", "handle", " ", "fractions", " ", 
      "correctly", "\n", "tf"}], ":=", 
     RowBox[{
      RowBox[{"TraditionalForm", "[", 
       RowBox[{"DisplayForm", "[", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Denominator", "[", "#", "]"}], "===", "1"}], ",", "#", 
          ",", 
          RowBox[{"FractionBox", "[", 
           RowBox[{
            RowBox[{"Numerator", "[", "#", "]"}], ",", 
            RowBox[{"Denominator", "[", "#", "]"}]}], "]"}]}], "]"}], "]"}], 
       "]"}], "&"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"tFqa", ":=", 
     RowBox[{
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"tF", "[", 
         RowBox[{"#", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"dummy", "'"}], "[", "_", "]"}], "\[Rule]", "1"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<==\>\"", "\[Rule]", "\"\<\[LongEqual]\>\""}], ",", 
          RowBox[{"\"\<\[Equal]\>\"", "\[Rule]", "\"\<\[LongEqual]\>\""}], 
          ",", 
          RowBox[{"\"\<capitalC\>\"", "\[Rule]", "\"\<C\>\""}], ",", 
          RowBox[{"\"\<zzone\>\"", "\[Rule]", "\"\<1\>\""}], ",", 
          RowBox[{"\"\<dummy\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<zdummy\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<log\>\"", "\[Rule]", "\"\<ln\>\""}], ",", 
          RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<\[LeftAngleBracket]\>\""}], 
          ",", 
          RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<\[RightAngleBracket]\>\""}]}], 
         "}"}]}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"tFb", ":=", 
     RowBox[{
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"tF", "[", "#1", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<[\>\""}], ",", 
          RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<]\>\""}]}], "}"}]}], "]"}], 
      "&"}]}], ";", "\n", "\[IndentingNewLine]", 
    RowBox[{"tf", ":=", 
     RowBox[{
      RowBox[{"TraditionalForm", "[", 
       RowBox[{"DisplayForm", "[", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Denominator", "[", "#", "]"}], "===", "1"}], ",", "#", 
          ",", 
          RowBox[{"FractionBox", "[", 
           RowBox[{
            RowBox[{"Numerator", "[", "#", "]"}], ",", 
            RowBox[{"Denominator", "[", "#", "]"}]}], "]"}]}], "]"}], "]"}], 
       "]"}], "&"}]}], ";"}], "*)"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "cartesianVector", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cartesianVector", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"tFq", "[", 
     RowBox[{"dummy", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cartesianVector", "[", "x_List", "]"}], ":=", 
    RowBox[{"tFq", "[", 
     RowBox[{"dummy", "@@", "x"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"columnVector", "=", 
    RowBox[{
     RowBox[{"tFq", "[", 
      RowBox[{"Partition", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rowVec", "=", "cartesianVector"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"colVec", "=", "columnVector"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angBrac", "=", 
    RowBox[{
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"tFq", "[", "#", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<\[LeftAngleBracket]\>\""}], ",", 
         RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<\[RightAngleBracket]\>\""}]}], 
        "}"}]}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"overBar", "=", 
    RowBox[{
     RowBox[{"OverBar", "[", 
      RowBox[{"Underoverscript", "[", 
       RowBox[{"#", ",", "\"\<\>\"", ",", "dummy"}], "]"}], "]"}], "&"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"overVector", "=", 
    RowBox[{
     RowBox[{"OverVector", "[", 
      RowBox[{"Underoverscript", "[", 
       RowBox[{"#", ",", "\"\<\>\"", ",", "dummy"}], "]"}], "]"}], "&"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"superSuperscript", "[", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "=", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Superscript", "[", 
       RowBox[{"x", ",", 
        RowBox[{"Superscript", "[", 
         RowBox[{"y", ",", "z"}], "]"}]}], "]"}], ",", 
      RowBox[{"ScriptBaselineShifts", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "1.5`"}], "}"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"superSuperscript", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Superscript", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"ScriptBaselineShifts", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "1.5`"}], "}"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToDumbVector", "[", 
     RowBox[{"l_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"VectorQ", "[", "#", "]"}], "&&", 
         RowBox[{
          RowBox[{"Length", "[", "#", "]"}], "<", "4"}]}], "&"}], ")"}]}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "locall", "}"}], ",", 
      RowBox[{
       RowBox[{"locall", "=", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"l", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", "3"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", ".", 
             RowBox[{"(", 
              RowBox[{"OverHat", "/@", 
               RowBox[{"toBold", "/@", 
                RowBox[{"{", 
                 RowBox[{"\"\<i\>\"", ",", "\"\<j\>\"", ",", "\"\<k\>\""}], 
                 "}"}]}]}], ")"}]}], ")"}], "&"}], "@", "locall"}], ",", 
         "StandardForm"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], "*",
       "\[IndentingNewLine]", "New", " ", "formatting", " ", "control", " ", 
      "functions", " ", "added"}], "  ", "-", 
     RowBox[{
     "mw", "  ", "20100714", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\t\t", 
      RowBox[{
       StyleBox["explicitNegQ",
        FontColor->RGBColor[0, 0, 1]], 
       StyleBox["[",
        FontColor->GrayLevel[0]], 
       StyleBox["expr",
        FontColor->GrayLevel[0]], 
       StyleBox["]",
        FontColor->GrayLevel[0]]}], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["returns",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["True",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["if",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["expr",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["has",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["an",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["explicit",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["\"\<-\>\"",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["out",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["front",
       FontColor->GrayLevel[0]], 
      StyleBox["\[IndentingNewLine]",
       FontColor->GrayLevel[0]], 
      StyleBox["\t\t\t\t\t\t\t",
       FontColor->GrayLevel[0]], 
      StyleBox["otherwise",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["it",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["returns",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["False",
       FontColor->GrayLevel[0]], 
      StyleBox["\[IndentingNewLine]",
       FontColor->GrayLevel[0]], 
      StyleBox["\t\t",
       FontColor->GrayLevel[0]], 
      RowBox[{
       StyleBox["wrapIfNeg",
        FontColor->RGBColor[0, 0, 1]], 
       StyleBox["[",
        FontColor->GrayLevel[0]], 
       StyleBox["expr",
        FontColor->GrayLevel[0]], 
       StyleBox["]",
        FontColor->GrayLevel[0]]}], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["returns",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["\"\<(tFq[expr])\>\"",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["if",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox[
       RowBox[{"explicitNegQ", "[", "expr", "]"}],
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["is",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["true",
       FontColor->GrayLevel[0]]}]}], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox[" ",
     FontColor->GrayLevel[0]], 
    StyleBox["\[IndentingNewLine]",
     FontColor->GrayLevel[0]], 
    StyleBox["\t\t\t\t\t\t\t\t",
     FontColor->GrayLevel[0]], 
    RowBox[{
     StyleBox[
      RowBox[{"tFq", "[", "expr", "]"}],
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox[
      RowBox[{"otherwise", ".", " ", "Output"}],
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["is",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["a",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     RowBox[{
      StyleBox["string",
       FontColor->GrayLevel[0]], 
      StyleBox[".",
       FontColor->GrayLevel[0]], 
      StyleBox["\[IndentingNewLine]",
       FontColor->GrayLevel[0]], 
      StyleBox["\t\t",
       FontColor->GrayLevel[0]], 
      RowBox[{
       StyleBox["keepOrderPlus",
        FontColor->RGBColor[0, 0, 1]], 
       StyleBox["[",
        FontColor->GrayLevel[0]], 
       StyleBox[" ",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"x", ",", " ", "y"}],
        FontColor->GrayLevel[0]], 
       StyleBox[" ",
        FontColor->GrayLevel[0]], 
       StyleBox["]",
        FontColor->GrayLevel[0]]}]}], 
     StyleBox["  ",
      FontColor->GrayLevel[0]], 
     StyleBox["returns",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["a",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["presentation",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["of",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["\"\<x + y\>\"",
      FontColor->GrayLevel[0]]}], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["\[IndentingNewLine]",
     FontColor->GrayLevel[0]], 
    StyleBox["\t\t\t\t\t",
     FontColor->GrayLevel[0]], 
    RowBox[{
     StyleBox["in",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["this",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["order",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["regardless",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["of",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["the",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["signs",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["of",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["x",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["and",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["y",
      FontColor->GrayLevel[0]], 
     StyleBox["\[IndentingNewLine]",
      FontColor->GrayLevel[0]], 
     StyleBox["\t\t",
      FontColor->GrayLevel[0]], 
     RowBox[{
      StyleBox["keepOrderTimes",
       FontColor->RGBColor[0, 0, 1]], 
      StyleBox["[",
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox[
       RowBox[{"x", ",", " ", "y"}],
       FontColor->GrayLevel[0]], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["]",
       FontColor->GrayLevel[0]]}], 
     StyleBox["  ",
      FontColor->GrayLevel[0]], 
     StyleBox["returns",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["a",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["presentation",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["of",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], 
     StyleBox["\"\<x \[Cross] y\>\"",
      FontColor->GrayLevel[0]]}], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["\[IndentingNewLine]",
     FontColor->GrayLevel[0]], 
    StyleBox["\t\t\t\t\t",
     FontColor->GrayLevel[0]], 
    StyleBox[
     RowBox[{
      RowBox[{
      "in", " ", "this", " ", "order", " ", "regardless", " ", "of", " ", 
       "the", " ", "signs", " ", "of", " ", "x", " ", "and", " ", "y", 
       "\[IndentingNewLine]", "                    ", "If", " ", "y"}], "<", 
      "0"}],
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox[" ",
     FontColor->GrayLevel[0]], 
    StyleBox[
     RowBox[{"it", " ", "is", " ", "wrapped", " ", "in", " ", "parentheses"}],
     
     FontColor->GrayLevel[0]]}], 
   StyleBox["\[IndentingNewLine]",
    FontColor->GrayLevel[0]], 
   "**************************)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"explicitNegQ", "[", 
    RowBox[{"expr_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"expr", "<", "0"}], ",", "True", ",", "False"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"explicitNegQ", "[", "expr_", "]"}], ":=", 
    RowBox[{
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"Head", "[", "expr", "]"}], ",", "Times"}], "]"}], "&&", 
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"expr", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"_", "?", "Negative"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"wrapIfNeg", "[", "expr_", "]"}], ":=", 
    RowBox[{"tFq", "[", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"explicitNegQ", "[", "expr", "]"}], ",", 
       RowBox[{"dummy", "[", "expr", "]"}], ",", "expr"}], "]"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"keepOrderPlus", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"x", ",", "0"}], "]"}], ",", 
      RowBox[{"tFq", "[", "y", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"y", ",", "0"}], "]"}], ",", 
      RowBox[{"tFq", "[", "x", "]"}], ",", "\[IndentingNewLine]", "True", ",", 
      RowBox[{
       RowBox[{"tFq", "[", "x", "]"}], "<>", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"explicitNegQ", "[", "y", "]"}], ",", 
         RowBox[{"\"\<\[ThinSpace]-\[ThinSpace]\>\"", "<>", 
          RowBox[{"tFq", "[", 
           RowBox[{"-", "y"}], "]"}]}], ",", 
         RowBox[{"\"\<\[ThinSpace]+\[ThinSpace]\>\"", "<>", 
          RowBox[{"tFq", "[", "y", "]"}]}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"keepOrderTimes", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"x", "|", "y"}], ",", "0"}], "]"}], ",", 
      RowBox[{"tFq", "[", "0", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"y", ",", "Null"}], "]"}], ",", 
      RowBox[{"tFq", "[", "x", "]"}], ",", "\[IndentingNewLine]", "True", ",", 
      RowBox[{
       RowBox[{"wrapIfNeg", "[", "x", "]"}], "<>", "\"\<\[ThinSpace]\>\"", "<>", 
       RowBox[{"wrapIfNeg", "[", "y", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "toBold", " ", "encloses", " ", "a", " ", "string", " ", "in", " ", "a", 
    " ", "Style", " ", "wrapper", " ", "for", " ", "bold", " ", "printing"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToBold", "[", "st_String", "]"}], ":=", 
   RowBox[{"toBold", "[", "st", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"toBold", "[", "st_String", "]"}], ":=", 
    RowBox[{"Style", "[", 
     RowBox[{"st", ",", 
      RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "is", " ", "a", " ", "processing", " ", "utility", " ", "for",
     " ", "serialization", " ", "of", " ", "files", " ", "in", " ", "hex"}], 
   "*)"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"toHexString", "[", "t_", "]"}], ":=", 
    RowBox[{"toHexString", "[", 
     RowBox[{"t", ",", "10"}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"toHexString", "[", 
     RowBox[{"t_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "s", "}"}], ",", 
      RowBox[{
       RowBox[{"s", "=", 
        RowBox[{"\"\<00000000000000000\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"BaseForm", "[", 
           RowBox[{"t", ",", "16"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{"StringDrop", "[", 
         RowBox[{"s", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"s", ",", "\"\<\\n\>\"", ",", "1"}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"StringLength", "[", "s", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"StringTake", "[", 
        RowBox[{"s", ",", 
         RowBox[{"-", "n"}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToSystem", "[", 
     RowBox[{"coefmatrix_", ",", "const_", ",", "varname_String"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MatrixQ", "[", "coefmatrix", "]"}], "&&", 
       RowBox[{"ListQ", "[", "const", "]"}], "&&", 
       RowBox[{
        RowBox[{"Length", "[", "coefmatrix", "]"}], "\[Equal]", 
        RowBox[{"Length", "[", "const", "]"}]}]}], ",", 
      RowBox[{"TableForm", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"DisplayForm", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"coefmatrix", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "k"}], "]"}], "]"}], "*", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"\"\<\\(\>\"", "<>", "varname", "<>", "\"\<\\_\>\"", "<>", 
                 RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<\\)\>\""}], 
                "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"coefmatrix", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "]"}], ",", "\"\<=\>\"", ",", 
           RowBox[{"const", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", "coefmatrix", "]"}]}], "}"}]}], "]"}], 
       "]"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**"}], "*", "\[IndentingNewLine]", "x", " ", "should", " ",
     "be", " ", "a", " ", "string", " ", "or", " ", "a", " ", "list", " ", 
    "of", " ", "strings", " ", "\[IndentingNewLine]", "Modified", " ", "30", 
    " ", "Mar", " ", "06", " ", "\[IndentingNewLine]", "now", " ", "accepts", 
    " ", "variable", " ", "lists", "  ", 
    RowBox[{"(", 
     RowBox[{
     "instead", " ", "of", " ", "only", " ", "subscripted", " ", "vars"}], 
     ")"}]}], "\[IndentingNewLine]", "******)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"displayDE", "[", 
     RowBox[{
      RowBox[{"A_", "?", "VectorQ"}], ",", "d_", ",", "dvar_Symbol"}], "]"}], 
    ":=", 
    RowBox[{"displayDE", "[", 
     RowBox[{
      RowBox[{"{", "A", "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Head", "[", "d", "]"}], ",", "List"}], "]"}], ",", "d", 
        ",", 
        RowBox[{"{", "d", "}"}]}], "]"}], ",", "dvar"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"displayDE", "[", 
     RowBox[{
      RowBox[{"A_", "?", "VectorQ"}], ",", "d_", ",", "dvar_Symbol", ",", 
      "ivar_Symbol"}], "]"}], ":=", 
    RowBox[{"displayDE", "[", 
     RowBox[{
      RowBox[{"{", "A", "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Head", "[", "d", "]"}], ",", "List"}], "]"}], ",", "d", 
        ",", 
        RowBox[{"{", "d", "}"}]}], "]"}], ",", "dvar", ",", "ivar"}], "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"displayDE", "[", 
     RowBox[{
      RowBox[{"A_", "?", "MatrixQ"}], ",", 
      RowBox[{"d_", "?", "VectorQ"}], ",", "dvar_Symbol"}], "]"}], ":=", 
    RowBox[{"systemGridBox", "[", 
     RowBox[{"A", ",", "d", ",", 
      RowBox[{"Reverse", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "#", "]"}], "[", "dvar", "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"A", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "]"}]}], 
        ")"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"displayDE", "[", 
     RowBox[{
      RowBox[{"A_", "?", "MatrixQ"}], ",", 
      RowBox[{"d_", "?", "VectorQ"}], ",", "dvar_Symbol", ",", 
      "ivar_Symbol"}], "]"}], ":=", 
    RowBox[{"systemGridBox", "[", 
     RowBox[{"A", ",", "d", ",", 
      RowBox[{"Reverse", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"dvar", "[", "ivar", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ivar", ",", "#"}], "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"A", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "]"}]}], 
        ")"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"displayDE", "[", 
     RowBox[{
      RowBox[{"A_", "?", "MatrixQ"}], ",", "d_", ",", "dvar_Symbol"}], "]"}], 
    ":=", 
    RowBox[{"displayDE", "[", 
     RowBox[{"A", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"d", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Dimensions", "[", "A", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}], ",", "dvar"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makeGridRow", "[", 
     RowBox[{
      RowBox[{"a_", "?", "VectorQ"}], ",", "d_", ",", "x_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"b", ",", "formatTerm"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "a", "]"}], "\[NotEqual]", 
          RowBox[{"Length", "[", "x", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "\"\<makeGridRow: BAD DATA\>\"", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"b", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{"Plus", ",", 
              RowBox[{"Head", "[", "#", "]"}]}], "]"}], ",", 
            RowBox[{"dummy", "[", "#", "]"}], "  ", ",", "#"}], "  ", "]"}], 
          "&"}], "/@", "a"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"formatTerm", "[", "n_Integer", "]"}], ":=", 
        RowBox[{"ReleaseHold", "[", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{
              "b", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], 
              ",", "0"}], "]"}], "||", 
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"Chop", "[", 
               RowBox[{
               "b", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], 
               "]"}], ",", "0"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"HoldForm", "[", 
            RowBox[{"Sequence", "[", 
             RowBox[{"\"\<\>\"", ",", "\"\<\>\"", ",", "\"\<\>\""}], "]"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"explicitNegQ", "[", 
              RowBox[{
              "b", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], 
              "]"}], ",", 
             RowBox[{"HoldForm", "[", 
              RowBox[{"Sequence", "[", 
               RowBox[{"\"\<\[ThinSpace]-\[ThinSpace]\>\"", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{
                    "b", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "\"\<\>\"", ",", 
                  RowBox[{"-", 
                   RowBox[{
                   "b", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
                "\"\<\[ThinSpace]\>\"", ",", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]}],
                "]"}], "]"}], ",", 
             RowBox[{"HoldForm", "[", 
              RowBox[{"Sequence", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"And", "@@", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{"#1", ",", "0"}], "]"}], "&"}], ")"}], "/@", 
                    RowBox[{"Chop", "/@", 
                    RowBox[{"Take", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}]}]}]}], ",", "\"\<\>\"", 
                  ",", "\"\<\[ThinSpace]+\[ThinSpace]\>\""}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "b", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "===", "1"}], ",", "\"\<\>\"", 
                  ",", 
                  RowBox[{
                  "b", "\[LeftDoubleBracket]", "n", 
                   "\[RightDoubleBracket]"}]}], "]"}], ",", 
                "\"\<\[ThinSpace]\>\"", ",", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]}],
                "]"}], "]"}]}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"formatTerm", "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "a", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[ThinSpace]\[LongEqual]\[ThinSpace]\>\"", ",", 
           RowBox[{"tF", "[", "d", "]"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "********************************************)"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"systemGridBox", "[", 
     RowBox[{
      RowBox[{"A_", "?", "MatrixQ"}], ",", 
      RowBox[{"d_", "?", "VectorQ"}], ",", "vars_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"j", ",", "m", ",", "n", ",", "x", ",", "xx"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "=", 
        RowBox[{"Dimensions", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"x", "=", "vars"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"m", "\[NotEqual]", 
          RowBox[{"Length", "[", "d", "]"}]}], ",", 
         RowBox[{
         "Return", "[", "\"\<uh oh, bad data -rows- [systemGridBox]\>\"", 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"vars", ",", "_String"}], "]"}], ",", 
         RowBox[{"x", "=", 
          RowBox[{"ToExpression", "[", "vars", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"xx", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Head", "[", "x", "]"}], ",", "List"}], "]"}], ",", 
          "\[IndentingNewLine]", "x", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"x", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"Range", "[", "n", "]"}]}]}], "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tFq", "@", 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"makeGridRow", "[", 
             RowBox[{
              RowBox[{"A", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"d", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", "xx"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "m"}], "}"}]}], "]"}], ",", 
          RowBox[{"Alignment", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Right", ",", "Baseline"}], "}"}]}], ",", 
          RowBox[{"Spacings", "\[Rule]", 
           RowBox[{"Scaled", "[", "0", "]"}]}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], "\n", 
  
  RowBox[{"(*", 
   RowBox[{"Returns", " ", "a", " ", "sequence", " ", "of", " ", 
    RowBox[{"True", "/", "False"}], " ", "corresponding", " ", "to", " ", 
    "the", " ", "binary", " ", "expansion", " ", "of", " ", "k", " ", 
    RowBox[{"(", 
     RowBox[{"0", "-", "7"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pick", "[", "k_Integer", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"BitAnd", "[", 
          RowBox[{"k", ",", "#"}], "]"}], "\[Equal]", "#"}], ")"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "4"}], "}"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
  "(*", "*************************************************)"}]}], "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"addlink", "[", "str_", "]"}], ":=", 
    RowBox[{
    "\"\< web reference '\>\"", "<>", "str", "<>", 
     "\"\<' (click here)\>\""}]}], ";"}], "\n", 
  RowBox[{
  "(*", "*************************************************)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "linkbase", "}"}], ",", 
     RowBox[{
      RowBox[{
      "linkbase", "=", 
       "\"\<http://www.math.vt.edu/people/quinn/calc_refs/\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"linkfor", "[", "\"\<Numerical Integration\>\"", "]"}], "=", 
       RowBox[{"linkbase", "<>", "\"\<num_int.pdf\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"linkfor", "[", "\"\<Proper and Improper Integrals\>\"", "]"}],
        "=", 
       RowBox[{"linkbase", "<>", "\"\<prop_imp_ints.pdf\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"linkfor", "[", "\"\<Derivatives of Integrals\>\"", "]"}], "=", 
       RowBox[{"linkbase", "<>", "\"\<deriv_int.pdf\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"linkfor", "[", "\"\<Integral Notations\>\"", "]"}], "=", 
       RowBox[{"linkbase", "<>", "\"\<int_note.pdf\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"linkfor", "[", "\"\<Improper Integrals\>\"", "]"}], "=", 
       RowBox[{"linkbase", "<>", "\"\<improp_ints.pdf\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"linkfor", "[", "\"\<Standard Integrals\>\"", "]"}], "=", 
       RowBox[{"linkbase", "<>", "\"\<stand_ints.pdf\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"linkfor", "[", "\"\<Substitution\>\"", "]"}], "=", 
       RowBox[{"linkbase", "<>", "\"\<substitution.pdf\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"linkfor", "[", "\"\<Completing the Square\>\"", "]"}], "=", 
       RowBox[{"linkbase", "<>", "\"\<comp_square.pdf\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"linkfor", "[", "\"\<Change of Variables\>\"", "]"}], "=", 
       RowBox[{"linkbase", "<>", "\"\<change_vars.pdf\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"linkfor", "[", "_", "]"}], ":=", "\"\<\>\""}], ";"}]}], "]"}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"random", " ", "numerical", " ", "entry"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"entry", "[", 
     RowBox[{"mx_", ",", "mid_", ",", "den_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "num", "}"}], ",", 
      RowBox[{
       RowBox[{"num", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "]"}], ">", "0"}], ",", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "-", "mx"}], ",", "mx"}], "}"}], "]"}], ",", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "-", "mid"}], ",", "mid"}], "}"}], "]"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"num", "\[LessEqual]", "0"}], ",", 
         RowBox[{"num", "=", 
          RowBox[{"num", "-", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"num", "/", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"den", "\[LessEqual]", "1"}], ",", "1", ",", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "den"}], "}"}], "]"}]}], "]"}]}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"random", " ", "symbol", " ", "entry"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"symbolentry", "[", 
     RowBox[{"symb_", ",", "cof_", ",", "mx_", ",", "md_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"cof", "\[LessEqual]", "0"}], ",", "symb", ",", 
        RowBox[{"cof", "\[Equal]", "1"}], ",", 
        RowBox[{"symb", "*", 
         RowBox[{"entry", "[", 
          RowBox[{"mx", ",", "md", ",", "0"}], "]"}]}], ",", 
        RowBox[{"cof", "\[Equal]", "2"}], ",", 
        RowBox[{"symb", "+", 
         RowBox[{"entry", "[", 
          RowBox[{"mx", ",", "md", ",", "0"}], "]"}]}], ",", "True", ",", 
        RowBox[{
         RowBox[{"symb", "*", 
          RowBox[{"entry", "[", 
           RowBox[{"mx", ",", "md", ",", "0"}], "]"}]}], "+", 
         RowBox[{"entry", "[", 
          RowBox[{"mx", ",", "md", ",", "0"}], "]"}]}]}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "find", " ", "matrices", " ", "with", " ", "specified", " ", 
    "properties"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindMatrix", "[", 
     RowBox[{"totros_", ",", "cls_", ",", "opts___"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "temp", ",", "ros", ",", "diag", ",", "ddepcols", ",", "openings", ",",
         "syros", ",", "syplace", ",", "zroplaces", ",", "temprow", ",", "r1",
         ",", "r2", ",", "c1", ",", "oldros"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"extract", " ", "option", " ", "information"}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"depros", ",", "depcol"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"mx", ",", "mid", ",", "den"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ech", ",", "rowop"}], "}"}], ",", "returnops", ",", 
          RowBox[{"{", 
           RowBox[{"zros", ",", "nearness"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "symb", ",", "syno", ",", "sydiag", ",", "synearness", ",", 
            "sycoef"}], "}"}]}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "DependenceData", ",", "CoefficientData", ",", "EchelonData", ",", 
            "ReturnRowOps", ",", "ZeroData", ",", "SymbolData"}], "}"}], "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "FindMatrix", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ros", "=", 
        RowBox[{"totros", "-", "depros"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"temp", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "ros", "}"}], ",", 
          RowBox[{"{", "cls", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"echelon", " ", "form"}], "*)"}], 
       RowBox[{"diagplaces", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ech", ">", "0"}], ",", 
         RowBox[{
          RowBox[{"diag", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "cls", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"choose", " ", "dependent", " ", "depcolumns"}], "*)"}], 
          RowBox[{"ddepcols", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"depcol", ">", "1"}], ",", 
             RowBox[{"ChooseRandom", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"Min", "[", 
                  RowBox[{"{", 
                   RowBox[{"cls", ",", "ros"}], "}"}], "]"}]}], "]"}], ",", 
               "depcol"}], "]"}], ",", 
             RowBox[{"depcol", "\[Equal]", "1"}], ",", 
             RowBox[{"ChooseRandom", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"2", ",", 
                 RowBox[{"Min", "[", 
                  RowBox[{"{", 
                   RowBox[{"cls", ",", "ros"}], "}"}], "]"}]}], "]"}], ",", 
               "depcol"}], "]"}], ",", 
             RowBox[{"depcol", "\[Equal]", "0"}], ",", 
             RowBox[{"{", "}"}], ",", 
             RowBox[{"depcol", ">", 
              RowBox[{"-", "3"}]}], ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "cls", "}"}], ",", 
               RowBox[{"ChooseRandom", "[", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"2", ",", 
                   RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"cls", "-", "1"}], ",", "ros"}], "}"}], "]"}]}], 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"Abs", "[", "depcol", "]"}], "-", "1"}]}], "]"}]}], 
              "]"}], ",", 
             RowBox[{"depcol", "\[LessEqual]", 
              RowBox[{"-", "3"}]}], ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "cls", "}"}], ",", 
               RowBox[{"ChooseRandom", "[", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"2", ",", 
                   RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{"cls", ",", "ros"}], "}"}], "]"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"Abs", "[", "depcol", "]"}], "-", "1"}]}], "]"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"\"\<diagonal\>\"", " ", "coords"}], "*)"}], 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Not", "[", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"ddepcols", ",", "j"}], "]"}], "]"}], "&&", 
               RowBox[{
                RowBox[{"Max", "[", "diag", "]"}], "<", "ros"}]}], ",", 
              RowBox[{
               RowBox[{"diag", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Max", "[", "diag", "]"}], "+", "1"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "cls"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"place", " ", "echelon", " ", "zeros"}], "*)"}], 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"temp", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "cls"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"diag", "[", 
                 RowBox[{"[", 
                  RowBox[{"Range", "[", 
                   RowBox[{"1", ",", "j"}], "]"}], "]"}], "]"}], "]"}], "+", 
               "1"}], ",", "ros"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"reduced", " ", "echelon", " ", "zeros"}], "*)"}], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ech", "\[GreaterEqual]", "3"}], ",", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"diag", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "\[LessEqual]", "ros"}], 
                ",", 
                RowBox[{
                 RowBox[{"temp", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "0"}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "cls"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"diag", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "-", "1"}]}], "}"}]}], 
             "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"echelon", " ", "1", "s"}], "*)"}], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ech", ">", "1"}], ",", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"diag", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"diag", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "\[LessEqual]", "ros"}]}], 
                ",", 
                RowBox[{
                 RowBox[{"temp", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"diag", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "j"}], "]"}], "]"}], 
                 "=", "1"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "cls"}], "}"}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"diagonal", " ", "places"}], "*)"}], 
          RowBox[{"diagrows", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"Union", "[", "diag", "]"}], ",", 
             RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"diagplaces", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"diagrows", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"1", ",", "cls"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"diag", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", "i"}], 
                  "&"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "diagrows", "]"}]}], "}"}]}], "]"}]}], 
          ";"}]}], "]"}], ";", 
       RowBox[{"(*", 
        RowBox[{"end", " ", "echelon", " ", "form"}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{"find", " ", "empty", " ", "spots"}], "*)"}], 
       RowBox[{"openings", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "ros"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "cls"}], "}"}]}], "]"}], ",", "1"}], "]"}], 
          ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"temp", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"{", "}"}]}], ")"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ech", ">", "0"}], ",", 
         RowBox[{"openings", "=", 
          RowBox[{"Complement", "[", 
           RowBox[{"openings", ",", "diagplaces"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"symbol", " ", "placement"}], "*)"}], 
       RowBox[{"syros", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"syno", ">", "0"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "i", "}"}], ",", 
           RowBox[{
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ech", ">", "0"}], "&&", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sydiag", "\[Equal]", "1"}], "||", 
                 RowBox[{
                  RowBox[{"Length", "[", "diagplaces", "]"}], "<", "3"}]}], 
                ")"}]}], ",", 
              RowBox[{"(*", 
               RowBox[{"on", " ", "diag"}], "*)"}], 
              RowBox[{
               RowBox[{
                RowBox[{"{", "syplace", "}"}], "=", 
                RowBox[{"ChooseRandom", "[", 
                 RowBox[{"diagplaces", ",", "1"}], "]"}]}], ";"}], ",", 
              RowBox[{
               RowBox[{"ech", ">", "0"}], "&&", 
               RowBox[{"sydiag", ">", "1"}]}], ",", 
              RowBox[{"(*", 
               RowBox[{"diagonal", ",", 
                RowBox[{"not", " ", "ends"}]}], "*)"}], 
              RowBox[{
               RowBox[{
                RowBox[{"{", "syplace", "}"}], "=", 
                RowBox[{"ChooseRandom", "[", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"Drop", "[", 
                    RowBox[{"diagplaces", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "1"}], "]"}], ",", 
                  "1"}], "]"}]}], ";"}], ",", 
              RowBox[{
               RowBox[{"ech", ">", "0"}], "&&", 
               RowBox[{"sydiag", "\[Equal]", 
                RowBox[{"-", "1"}]}]}], ",", 
              RowBox[{"(*", 
               RowBox[{"off", " ", "diagonal"}], "*)"}], 
              RowBox[{
               RowBox[{
                RowBox[{"{", "syplace", "}"}], "=", 
                RowBox[{"ChooseRandom", "[", 
                 RowBox[{"openings", ",", "1"}], "]"}]}], ";"}], ",", 
              RowBox[{
               RowBox[{"ech", ">", "0"}], "&&", 
               RowBox[{"sydiag", "<", 
                RowBox[{"-", "1"}]}]}], ",", 
              RowBox[{"(*", 
               RowBox[{"off", " ", "diagonal", " ", "not", " ", "ends"}], 
               "*)"}], 
              RowBox[{
               RowBox[{"midopenings", "=", 
                RowBox[{"Select", "[", 
                 RowBox[{"openings", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "1"}], "&&", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "ros"}]}], 
                    ")"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"midopenings", "\[Equal]", 
                  RowBox[{"{", "}"}]}], ",", 
                 RowBox[{"midopenings", "=", 
                  RowBox[{"Select", "[", 
                   RowBox[{"openings", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "ros"}], 
                    ")"}], "&"}]}], "]"}]}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"midopenings", "\[Equal]", 
                  RowBox[{"{", "}"}]}], ",", 
                 RowBox[{"midopenings", "=", "openings"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", "syplace", "}"}], "=", 
                RowBox[{"ChooseRandom", "[", 
                 RowBox[{"midopenings", ",", "1"}], "]"}]}], ";"}], ",", 
              RowBox[{
               RowBox[{"ech", "\[Equal]", "0"}], "||", 
               RowBox[{"sydiag", "\[Equal]", "0"}]}], ",", 
              RowBox[{"(*", "random", "*)"}], 
              RowBox[{
               RowBox[{
                RowBox[{"{", "syplace", "}"}], "=", 
                RowBox[{"ChooseRandom", "[", 
                 RowBox[{
                  RowBox[{"Union", "[", 
                   RowBox[{"openings", ",", "diagplaces"}], "]"}], ",", "1"}],
                  "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"syros", "=", 
             RowBox[{"{", 
              RowBox[{"syplace", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"temp", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"syplace", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"syplace", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
             RowBox[{"symbolentry", "[", 
              RowBox[{"symb", ",", "sycoef", ",", "mx", ",", "mid"}], "]"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"openings", "=", 
             RowBox[{"Complement", "[", 
              RowBox[{"openings", ",", 
               RowBox[{"{", "syplace", "}"}]}], "]"}]}], ";"}]}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"randomly", " ", "placed", " ", "zeros"}], "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"zros", "\[NotEqual]", "0"}], ",", 
         RowBox[{
          RowBox[{"totalzros", "=", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "openings", "]"}], "*", 
              RowBox[{"Abs", "[", "zros", "]"}]}], "+", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"syros", "\[Equal]", 
                RowBox[{"{", "}"}]}], ",", "0", ",", ".5"}], "]"}]}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"zroplaces", "=", 
           RowBox[{"ChooseRandom", "[", 
            RowBox[{"openings", ",", "totalzros"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", "0"}], 
             ")"}], "&"}], "/@", "zroplaces"}], ";", "\[IndentingNewLine]", 
          RowBox[{"openings", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{"openings", ",", "zroplaces"}], "]"}]}], ";"}]}], "]"}], 
       ";", 
       RowBox[{"(*", 
        RowBox[{"end", " ", "place", " ", "zeros"}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{"fill", " ", "openings"}], "*)"}], 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"temp", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{
            RowBox[{"temp", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{"entry", "[", 
             RowBox[{"mx", ",", "mid", ",", "den"}], "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "ros"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "cls"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"row", " ", "ops", " ", "in", " ", "echelon", " ", "case"}], 
        "*)"}], 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"rowop", "<", "0"}], ",", 
         RowBox[{
          RowBox[{"cyc", "=", 
           RowBox[{"ChooseRandom", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "ros"}], "]"}], ",", 
             RowBox[{"Abs", "[", "rowop", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"temprow", "=", 
           RowBox[{"temp", "[", 
            RowBox[{"[", 
             RowBox[{"cyc", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"temp", "[", 
              RowBox[{"[", 
               RowBox[{"cyc", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
             RowBox[{"temp", "[", 
              RowBox[{"[", 
               RowBox[{"cyc", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"Length", "[", "cyc", "]"}], "-", "1"}]}], "}"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"temp", "[", 
            RowBox[{"[", 
             RowBox[{"cyc", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
           "temprow"}], ";"}], ",", 
         RowBox[{
          RowBox[{"rowop", "\[Equal]", "1"}], "||", 
          RowBox[{"ros", "\[LessEqual]", "2"}]}], ",", 
         RowBox[{
          RowBox[{"r1", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"syros", "\[Equal]", 
              RowBox[{"{", "ros", "}"}]}], ",", 
             RowBox[{"ros", "-", "1"}], ",", "ros"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "c1", "}"}], "=", 
           RowBox[{"ChooseRandom", "[", 
            RowBox[{
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"-", "mid"}], ",", "mid"}], "]"}], ",", 
               RowBox[{"{", "0", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"toprows", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "ros"}], "]"}], ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "r1", "}"}], ",", "syros"}], "]"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"toprows", "\[Equal]", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", 
                RowBox[{"syros", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"temp", "[", 
                RowBox[{"[", 
                 RowBox[{"syros", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+", 
               RowBox[{"c1", "*", 
                RowBox[{"temp", "[", 
                 RowBox[{"[", "r1", "]"}], "]"}]}]}]}], ";"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"{", "r2", "}"}], "=", 
              RowBox[{"ChooseRandom", "[", 
               RowBox[{"toprows", ",", "1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", "r1", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"temp", "[", 
                RowBox[{"[", "r1", "]"}], "]"}], "+", 
               RowBox[{"c1", "*", 
                RowBox[{"temp", "[", 
                 RowBox[{"[", "r2", "]"}], "]"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"temprow", "=", 
              RowBox[{"temp", "[", 
               RowBox[{"[", "r2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"{", "r1", "}"}], "=", 
              RowBox[{"ChooseRandom", "[", 
               RowBox[{
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"1", ",", "ros"}], "]"}], ",", 
                  RowBox[{"{", "r2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", "r2", "]"}], "]"}], "=", 
              RowBox[{"temp", "[", 
               RowBox[{"[", "r1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", "r1", "]"}], "]"}], "=", "temprow"}], ";"}]}], 
           "]"}], ";"}], ",", 
         RowBox[{
          RowBox[{"rowop", ">", "1"}], "&&", 
          RowBox[{"ros", ">", "2"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"r1", ",", "r2"}], "}"}], "=", 
           RowBox[{"ChooseRandom", "[", 
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"Complement", "[", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"1", ",", "ros"}], "]"}], ",", "syros"}], "]"}], 
               ",", 
               RowBox[{"-", "2"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c1", ",", "c2"}], "}"}], "=", 
           RowBox[{"ChooseRandom", "[", 
            RowBox[{
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"-", "mid"}], ",", "mid"}], "]"}], ",", 
               RowBox[{"{", "0", "}"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"toprows", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "ros"}], "]"}], ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"r1", ",", "r2"}], "}"}], ",", "syros"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"toprows", "\[Equal]", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", "r2", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"temp", "[", 
                RowBox[{"[", "r2", "]"}], "]"}], "+", 
               RowBox[{"c1", "*", 
                RowBox[{"temp", "[", 
                 RowBox[{"[", "r1", "]"}], "]"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", "r1", "]"}], "]"}], "=", 
              RowBox[{"c1", "*", 
               RowBox[{"temp", "[", 
                RowBox[{"[", 
                 RowBox[{"toprows", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"r1", ",", "r2"}], "}"}], "=", 
              RowBox[{"ChooseRandom", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", "ros"}], "]"}], ",", "2"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"temprow", "=", 
              RowBox[{"temp", "[", 
               RowBox[{"[", "r2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", "r2", "]"}], "]"}], "=", 
              RowBox[{"temp", "[", 
               RowBox[{"[", "r1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", "r1", "]"}], "]"}], "=", "temprow"}], ";"}], ",", 
            
            RowBox[{"(*", 
             RowBox[{"toprows", " ", "nonempty"}], "*)"}], 
            RowBox[{
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", "r1", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"temp", "[", 
                RowBox[{"[", "r1", "]"}], "]"}], "+", 
               RowBox[{"c1", "*", 
                RowBox[{"temp", "[", 
                 RowBox[{"[", 
                  RowBox[{"toprows", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", "r2", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"temp", "[", 
                RowBox[{"[", "r2", "]"}], "]"}], "+", 
               RowBox[{"c2", "*", 
                RowBox[{"temp", "[", 
                 RowBox[{"[", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "toprows", "]"}], ">", "1"}], ",", 
                    
                    RowBox[{"toprows", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"toprows", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], 
                 "]"}]}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"cyc", "=", 
              RowBox[{"ChooseRandom", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", "ros"}], "]"}], ",", "3"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"temprow", "=", 
              RowBox[{"temp", "[", 
               RowBox[{"[", 
                RowBox[{"cyc", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"temp", "[", 
                 RowBox[{"[", 
                  RowBox[{"cyc", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
                RowBox[{"temp", "[", 
                 RowBox[{"[", 
                  RowBox[{"cyc", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "cyc", "]"}], "-", "1"}]}], "}"}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", 
                RowBox[{"cyc", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
              "temprow"}], ";"}]}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"dependent", " ", "rows"}], "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"depros", "\[NotEqual]", "0"}], ",", 
         RowBox[{
          RowBox[{"oldros", "=", 
           RowBox[{"ChooseRandom", "[", 
            RowBox[{
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", "ros"}], "]"}], ",", "syros"}], "]"}], ",", 
             
             RowBox[{
              RowBox[{"Abs", "[", "depros", "]"}], "+", "1"}]}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"temp", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"temp", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"r1", "=", 
                 RowBox[{"RandomInteger", "[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"{", 
                    RowBox[{"mid", ",", "4"}], "}"}], "]"}]}], "}"}], "]"}]}],
                 ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"temp", "[", 
                  RowBox[{"[", 
                   RowBox[{"oldros", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", 
                 RowBox[{"r1", "*", 
                  RowBox[{"temp", "[", 
                   RowBox[{"[", 
                    RowBox[{"oldros", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}], "]"}]}]}]}],
                ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "oldros", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}]}], "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "temp"}]}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"*", "end", " ", "findmatrix"}], "**)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "FindMatrix", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DependenceData", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", 
      RowBox[{"CoefficientData", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"9", ",", "3", ",", "1"}], "}"}]}], ",", 
      RowBox[{"EchelonData", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", 
      RowBox[{"ReturnRowOps", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", 
      RowBox[{"ZeroData", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", 
      RowBox[{"SymbolData", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"a", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "constructs", " ", "matrices", " ", "in", " ", "reduced", " ", "echelon", 
     " ", "form"}], ",", 
    RowBox[{"with", " ", "specified", " ", "errors"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EchelonMatrix", "[", 
     RowBox[{"ros_", ",", "cols_", ",", "rnk_", ",", "opts___"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "err", ",", "badcols", ",", "goodcols", ",", "mtx", ",", "cl", ",", 
        "badplace", ",", "perm"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"collect", " ", "options"}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"{", "err", "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "ErrorType", "}"}], "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "EchelonMatrix", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"badcols", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"rnk", "<", "3"}], ",", 
          RowBox[{"ChooseRandom", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"2", ",", "cols"}], "]"}], ",", 
            RowBox[{"cols", "-", "rnk"}]}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"else", " ", "rnk"}], ">", "2"}], "*)"}], 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"ChooseRandom", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"2", ",", 
                RowBox[{"cols", "-", "1"}]}], "]"}], ",", 
              RowBox[{"cols", "-", "rnk", "-", "1"}]}], "]"}], ",", 
            RowBox[{"{", "cols", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"goodcols", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "cols"}], "]"}], ",", "badcols"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "initialize", "*)"}], 
       RowBox[{"mtx", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "ros", "}"}], ",", 
          RowBox[{"{", "cols", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"leading", " ", "1"}], "*)"}], 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"mtx", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", 
             RowBox[{"goodcols", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], "=", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "rnk"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"other", " ", "entries"}], "*)"}], 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"mtx", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", 
             RowBox[{"badcols", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"RandomInteger", "[", "]"}], "*", 
           RowBox[{"entry", "[", 
            RowBox[{"7", ",", "5", ",", "0"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "badcols", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{
            RowBox[{"badcols", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", "i"}]}], "}"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "errors", "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"err", "\[Equal]", "1"}], ",", 
         RowBox[{"(*", " ", 
          RowBox[{"\[NotEqual]", 
           RowBox[{
           "0", " ", "elet", " ", "above", " ", "leading", " ", "1"}]}], 
          "*)"}], 
         RowBox[{
          RowBox[{"badplace", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"rnk", "\[Equal]", "2"}], ",", "1", ",", 
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"rnk", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"rnk", "-", "1"}], ")"}], "/", "2"}]}]}], "}"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"cl", "=", "2"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"badplace", ">", 
             RowBox[{"cl", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"cl", "-", "1"}], ")"}], "/", "2"}]}]}], ",", 
            RowBox[{"cl", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mtx", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"badplace", "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"cl", "-", "1"}], ")"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"cl", "-", "2"}], ")"}], "/", "2"}]}]}], ",", 
              RowBox[{"goodcols", "[", 
               RowBox[{"[", "cl", "]"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"entry", "[", 
            RowBox[{"7", ",", "5", ",", "0"}], "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"err", "\[Equal]", "2"}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"-", "1"}], " ", "leading", " ", "entry"}], "*)"}], 
         RowBox[{
          RowBox[{"badplace", "=", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "rnk"}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mtx", "[", 
            RowBox[{"[", 
             RowBox[{"badplace", ",", 
              RowBox[{"goodcols", "[", 
               RowBox[{"[", "badplace", "]"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"-", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"err", "\[Equal]", "3"}], ",", 
         RowBox[{"(*", 
          RowBox[{"zero", " ", "row", " ", "out", " ", "of", " ", "place"}], 
          "*)"}], 
         RowBox[{
          RowBox[{"badplace", "=", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"2", ",", "rnk"}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"perm", "=", 
           RowBox[{"Insert", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", 
               RowBox[{"ros", "-", "1"}]}], "]"}], ",", "ros", ",", 
             "badplace"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"mtx", "=", 
           RowBox[{"mtx", "[", 
            RowBox[{"[", "perm", "]"}], "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "return", "*)"}], "mtx"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "EchelonMatrix", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"ErrorType", "\[Rule]", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{
  "(*", "*************************************************)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindEigenMatrix", "[", 
     RowBox[{"rk_", ",", "opts___"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "basic", ",", "dev", ",", "diag0", ",", "rdata", ",", "evdata", ",", 
        "mtx", ",", "diag", ",", "zeroplaces", ",", "zerows", ",", 
        "devplaces", ",", "otherplaces", ",", "entries", ",", "changesign", 
        ",", "coefftable", ",", "a", ",", "okplaces", ",", "i", ",", "j", ",",
         "prob", ",", "ans", ",", "output", ",", "p", ",", "pl", ",", "i2", 
        ",", "j2"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"basic", ",", "dev", ",", "diag0"}], "}"}], ",", "rdata", 
          ",", "evdata"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ZeroData", ",", "ReturnData", ",", "EigenData"}], "}"}], "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "FindEigenMatrix", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"find", " ", "a", " ", "matrix"}], "*)"}], 
       RowBox[{"mtx", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "rk", "}"}], ",", 
          RowBox[{"{", "rk", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "diagonal", "*)"}], 
       RowBox[{"diag", "=", 
        RowBox[{"ChooseRandom", "[", 
         RowBox[{
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "3"}], ",", "3"}], "]"}], ",", 
            RowBox[{"{", "0", "}"}]}], "]"}], ",", 
          RowBox[{"rk", "-", "diag0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"diag", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"diag", ",", "0", ",", 
          RowBox[{"ChooseRandom", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", "i", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"rk", "-", "diag0", "+", "1"}]}], "}"}]}], "]"}], ",",
             "diag0"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"mtx", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
          RowBox[{"diag", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "rk"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"other", " ", "entries"}], "*)"}], 
       RowBox[{"zeroplaces", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"basic", "\[LessEqual]", "0"}], ",", 
         RowBox[{"zeroplaces", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"zeroplaces", ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", "j"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"rk", "-", "1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"i", "+", "1"}], ",", "rk"}], "}"}]}], "]"}], ",", 
              "1"}], "]"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"basic", "\[GreaterEqual]", "0"}], "&&", 
          RowBox[{"basic", "<", "2"}]}], ",", 
         RowBox[{"zeroplaces", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"zeroplaces", ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", "j"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "rk"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], 
             "]"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"zerows", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"basic", "\[LessEqual]", "1"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"ChooseRandom", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "rk"}], "]"}], ",", 
            RowBox[{"basic", "-", "1"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"zerows", "\[NotEqual]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"zerows", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"RandomInteger", "[", "]"}]}], ")"}], 
           RowBox[{"zerows", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "zerows", "]"}], ">", "1"}], ",", 
         RowBox[{
          RowBox[{"zerows", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sign", "[", 
             RowBox[{"zerows", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], 
           RowBox[{"zerows", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zeroplaces", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"zeroplaces", ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"p", "=", 
                RowBox[{"zerows", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ";", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"p", ">", "0"}], "&&", 
                  RowBox[{"j", "<", "p"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"p", ",", "j"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"p", ">", "0"}], "&&", 
                  RowBox[{"j", "\[GreaterEqual]", "p"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"p", ",", 
                   RowBox[{"j", "+", "1"}]}], "}"}], ",", 
                 RowBox[{"j", "<", 
                  RowBox[{"-", "p"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"-", "p"}]}], "}"}], ",", 
                 RowBox[{"j", "\[GreaterEqual]", 
                  RowBox[{"-", "p"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"j", "+", "1"}], ",", 
                   RowBox[{"-", "p"}]}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "zerows", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"rk", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "deviations", "*)"}], 
       RowBox[{"devplaces", "=", 
        RowBox[{"ChooseRandom", "[", 
         RowBox[{"zeroplaces", ",", "dev"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"otherplaces", "=", 
        RowBox[{"Union", "[", 
         RowBox[{"devplaces", ",", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"j", "<", "i"}], ",", "j", ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "rk"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"rk", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], 
             "]"}], ",", "zeroplaces"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"fill", " ", "nonzero", " ", "places"}], "*)"}], 
       RowBox[{"entries", "=", 
        RowBox[{"ChooseRandom", "[", 
         RowBox[{
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "7"}], ",", "7"}], "]"}], ",", 
            RowBox[{"{", "0", "}"}]}], "]"}], ",", 
          RowBox[{"Length", "[", "otherplaces", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"mtx", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"otherplaces", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"otherplaces", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], "=", 
          RowBox[{"entries", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "otherplaces", "]"}]}], "}"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"adjust", " ", "eigenvalues", " ", "when", " ", "2", "x2"}], 
         "+", "triangular"}], "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"basic", "<", "2"}], "&&", 
            RowBox[{"dev", "\[Equal]", "1"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"rk", "-", "basic"}], "\[Equal]", "1"}], "&&", 
            RowBox[{"dev", "\[Equal]", "0"}]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i2", ",", "j2"}], "}"}], "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"basic", "<", "2"}], ",", 
             RowBox[{"Sort", "[", 
              RowBox[{"devplaces", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", "rk"}], "]"}], ",", 
               RowBox[{"Abs", "[", "zerows", "]"}]}], "]"}]}], "]"}]}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"**", "**", "assemble"}], " ", "output"}], ",", 
         RowBox[{
         "depending", " ", "on", " ", "value", " ", "of", " ", "rdata"}]}], 
        "********)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rdata", "\[Equal]", "0"}], ",", 
         RowBox[{"output", "=", "mtx"}]}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"(*", 
        RowBox[{"characteristic", " ", "polynomial"}], "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rdata", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", "basic", "]"}], "<", "2"}], "||", 
               RowBox[{
                RowBox[{"rk", "-", "basic"}], "\[Equal]", "0"}]}], ")"}], "&&", 
             RowBox[{"dev", "\[Equal]", "0"}]}], ",", 
            RowBox[{"(*", "triangular", "*)"}], 
            RowBox[{
             RowBox[{"changesign", "=", 
              RowBox[{"ChooseRandom", "[", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"1", ",", "rk"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"diag", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "\[NotEqual]", "0"}], 
                   "&"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"coefftable", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Coefficient", "[", 
                   RowBox[{
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"a", "-", 
                    RowBox[{
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{"kkk", "\[Equal]", "1"}], ",", "1", ",", 
                    RowBox[{"kkk", "\[Equal]", "2"}], ",", 
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"kkk", "\[Equal]", "3"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"changesign", ",", "i"}], "]"}], ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "]"}], ",", 
                    RowBox[{"kkk", "\[Equal]", "4"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"changesign", ",", "i"}], "]"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "]"}], "*", 
                    RowBox[{"diag", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "rk"}], "}"}]}], "]"}], ",", "a", ",", 
                    "jjj"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"jjj", ",", "0", ",", "rk"}], "}"}]}], "]"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"kkk", ",", "4"}], "}"}]}], "]"}]}], ";"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"basic", "<", "2"}], "&&", 
               RowBox[{"dev", "\[Equal]", "1"}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"rk", "-", "basic"}], "\[Equal]", "1"}], "&&", 
               RowBox[{"dev", "\[Equal]", "0"}]}], ")"}]}], ",", 
            RowBox[{"(*", 
             RowBox[{"triangular", "+", 
              RowBox[{"2", "x2"}]}], "*)"}], 
            RowBox[{
             RowBox[{"devplaces", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"basic", "<", "2"}], ",", 
                RowBox[{"devplaces", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"1", ",", "rk"}], "]"}], ",", 
                  RowBox[{"Abs", "[", "zerows", "]"}]}], "]"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}], "=", "devplaces"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"okplaces", "=", 
              RowBox[{"Complement", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", "rk"}], "]"}], ",", "devplaces"}], "]"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"coefftable", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"CoefficientList", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"a", "-", 
                    RowBox[{"diag", "[", 
                    RowBox[{"[", 
                    RowBox[{"okplaces", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"rk", "-", "2"}]}], "}"}]}], "]"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"a", "-", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"OddQ", "[", "kkk", "]"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}], 
                    RowBox[{"diag", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"a", "-", 
                    RowBox[{"diag", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"kkk", "<", "2"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}], 
                    RowBox[{"mtx", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], 
                    RowBox[{"mtx", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}]}]}], ")"}]}], ",", 
                  "a"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"kkk", ",", "4"}], "}"}]}], "]"}]}], ";"}], ",", 
            "True", ",", 
            RowBox[{"(*", 
             RowBox[{"other", " ", "cases"}], "*)"}], 
            RowBox[{
             RowBox[{"coefftable", "=", 
              RowBox[{"CoefficientList", "[", 
               RowBox[{
                RowBox[{"Det", "[", 
                 RowBox[{"mtx", "-", 
                  RowBox[{"a", " ", 
                   RowBox[{"IdentityMatrix", "[", "rk", "]"}]}]}], "]"}], ",",
                 "a"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"coefftable", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"coefftable", ",", 
                RowBox[{"{", "4", "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"fix", " ", "duplicate", " ", "answers"}], "*)"}], 
          RowBox[{"ans", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"coefftable", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"2", ",", "3", ",", "4"}], "}"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"coefftable", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "ans", "]"}], "<", "3"}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "ans", "]"}], "<", "2"}], ",", 
               RowBox[{
                RowBox[{"pl", "=", 
                 RowBox[{"RandomInteger", "[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "rk"}], "}"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"ans", ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"coefftable", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], "+", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "pl"}], ",", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "]"}], ",", "0"}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"rk", "+", "1"}]}], "}"}]}], "]"}]}], "]"}], 
                ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"changesign", "=", 
              RowBox[{"Union", "[", 
               RowBox[{"ChooseRandom", "[", 
                RowBox[{
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"Range", "[", 
                    RowBox[{"1", ",", "rk"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"coefftable", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "#"}], "]"}], "]"}], "\[NotEqual]", 
                    "0"}], "&"}]}], "]"}], ",", "2"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"coefftable", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"changesign", ",", "i"}], "]"}], ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"rk", "+", "1"}]}], "}"}]}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ans", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"changesign", ",", "i"}], "]"}], ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"rk", "+", "1"}]}], "}"}]}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ans", "=", 
              RowBox[{"Union", "[", "ans", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"coefftable", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "3", ",", "4"}], "}"}], "]"}], "]"}], "=", 
              
              RowBox[{"ans", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}]}], 
             ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"output", "=", 
           RowBox[{"{", 
            RowBox[{"mtx", ",", "coefftable"}], "}"}]}], ";"}]}], "]"}], ";", 
       
       RowBox[{"(*", 
        RowBox[{"end", " ", "ch", " ", "polynomial"}], "*)"}], "output"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "FindEigenMatrix", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ZeroData", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
      RowBox[{"ReturnData", "\[Rule]", "0"}], ",", 
      RowBox[{"EigenData", "\[Rule]", "0"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "function", " ", "creates", " ", "an", " ", "integer", " ", 
    "coefficient", " ", "2", "x2", " ", "matrix", " ", "with", " ", "a", " ", 
    "specified", " ", "determinant", 
    RowBox[{
     RowBox[{"(", "n", ")"}], "."}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"msWithDet", "[", "n_", "]"}], ":=", 
    RowBox[{
     RowBox[{"msWithDet", "[", "n", "]"}], "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Outer", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#1", ",", "#2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"#3", ",", "#4"}], "}"}]}], "}"}], "&"}], ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "4"}], ",", "4"}], "]"}], ",", 
            RowBox[{"1", "/", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "4"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "4"}], "]"}]}]}], "]"}], ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "4"}], ",", "4"}], "]"}], ",", 
            RowBox[{"1", "/", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "4"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "4"}], "]"}]}]}], "]"}], ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "4"}], ",", "4"}], "]"}], ",", 
            RowBox[{"1", "/", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "4"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "4"}], "]"}]}]}], "]"}], ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "4"}], ",", "4"}], "]"}], ",", 
            RowBox[{"1", "/", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "4"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "4"}], "]"}]}]}], "]"}]}], "]"}], "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "3"}], "]"}], "&"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Det", "[", "#", "]"}], "\[Equal]", "n"}], "&"}]}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{
  "(*", "*************************************************)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EigenMatrix", "[", 
     RowBox[{"dim_", ",", "opts___"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "cored", ",", "rtype", ",", "combod", ",", "mtx", ",", "coredim", ",", 
        "evtype", ",", "diag0", ",", "aaa", ",", "bbb", ",", "ccc", ",", 
        "ddd", ",", "t", ",", "iii"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cored", ",", "rtype", ",", "combod"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"CoreData", ",", "ReturnType", ",", "ComboData"}], "}"}], "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "EigenMatrix", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"construct", " ", "core"}], "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dim", "\[Equal]", 
          RowBox[{"cored", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"(*", 
          RowBox[{"just", " ", "core"}], "*)"}], 
         RowBox[{
          RowBox[{"coredim", "=", 
           RowBox[{"cored", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"coredim", "\[Equal]", "1"}], ",", 
            RowBox[{"mtx", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"cored", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[Equal]", "0"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"{", "0", "}"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"ChooseRandom", "[", 
                 RowBox[{
                  RowBox[{"Complement", "[", 
                   RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"-", "9"}], ",", "9"}], "]"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "]"}], ",", "1"}], "]"}], 
                "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"coredim", "\[Equal]", "2"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"diag0", ",", "evtype"}], "}"}], "=", 
              RowBox[{"cored", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"evtype", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{"evtype", ",", "4"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"evtype", "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"bbb", ",", "ccc"}], "}"}], "=", 
                 RowBox[{"ChooseRandom", "[", 
                  RowBox[{
                   RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"-", "4"}], ",", "4"}], "]"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "]"}], ",", "2"}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"t", "=", 
                 RowBox[{"RandomInteger", "[", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", "4"}], "}"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"bbb", "\[Equal]", 
                   RowBox[{"t", "*", "ccc"}]}], ",", 
                  RowBox[{"t", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"diag0", "\[Equal]", "0"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", "aaa", "}"}], "=", 
                    RowBox[{"ChooseRandom", "[", 
                    RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "8"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "bbb", ",", "ccc"}], "}"}]}], "]"}], 
                    ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"ddd", "=", 
                    RowBox[{"aaa", "+", "bbb", "-", 
                    RowBox[{"t", "*", "ccc"}]}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"bbb", "=", 
                    RowBox[{"bbb", "*", "t"}]}], ";"}], ",", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"else", " ", "diag0"}], ">", "0"}], "*)"}], 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"aaa", ",", "bbb", ",", "ddd"}], "}"}], "=", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomInteger", "[", "]"}], "\[Equal]", "0"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"bbb", "*", "t"}], ",", 
                    RowBox[{"bbb", "-", 
                    RowBox[{"t", "*", "ccc"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"t", "*", "ccc"}], "-", "bbb"}], ",", 
                    RowBox[{"bbb", "*", "t"}], ",", "0"}], "}"}]}], "]"}]}]}],
                  "]"}]}], ",", 
               RowBox[{"evtype", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"aaa", ",", "bbb", ",", "ccc"}], "}"}], "=", 
                 RowBox[{"ChooseRandom", "[", 
                  RowBox[{
                   RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "7"}], "]"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "]"}], ",", "3"}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"ddd", "=", 
                 RowBox[{"aaa", "+", 
                  RowBox[{
                   RowBox[{"Sign", "[", "aaa", "]"}], " ", 
                   RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "5"}], "}"}], "]"}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"diag0", ">", "0"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"RandomInteger", "[", "]"}], "\[Equal]", "0"}], 
                    ",", 
                    RowBox[{"aaa", "=", "0"}], ",", 
                    RowBox[{"ddd", "=", "0"}]}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"While", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"t", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"aaa", "-", "ddd"}], ")"}], "^", "2"}], "+", 
                    RowBox[{"4", " ", "bbb", " ", "ccc"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"t", "\[LessEqual]", "0"}], "||", 
                    RowBox[{"IntegerQ", "[", 
                    RowBox[{"Sqrt", "[", "t", "]"}], "]"}]}]}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"ddd", "\[NotEqual]", "0"}], ",", 
                    RowBox[{"ddd", "=", 
                    RowBox[{"ddd", "+", 
                    RowBox[{"Sign", "[", "ddd", "]"}]}]}], ",", 
                    RowBox[{"aaa", "=", 
                    RowBox[{"aaa", "+", 
                    RowBox[{"Sign", "[", "aaa", "]"}]}]}]}], "]"}]}], "]"}], 
                ";"}], ",", 
               RowBox[{"evtype", "\[Equal]", "2"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"iii", ",", "bbb", ",", "ccc"}], "}"}], "=", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1", ",", "8"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2", ",", "4"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "2", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "2", ",", "9"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "3", ",", "6"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "5", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "5", ",", "9"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"8", ",", "4", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"8", ",", "5", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"8", ",", "4", ",", "8"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"10", ",", "5", ",", "10"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"12", ",", "5", ",", "8"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"12", ",", "5", ",", "9"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"14", ",", "5", ",", "10"}], "}"}]}], "}"}], "[", 
                  
                  RowBox[{"[", 
                   RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "19"}], "}"}], "]"}], "]"}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"t", "=", 
                 RowBox[{"RandomInteger", "[", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "3"}], "}"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"bbb", ",", "ccc"}], "}"}], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", "t"}], " ", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"t", "<", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"bbb", ",", 
                    RowBox[{"-", "ccc"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ccc", ",", 
                    RowBox[{"-", "bbb"}]}], "}"}]}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", "t", "}"}], "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"diag0", "\[Equal]", "0"}], ",", 
                   RowBox[{"ChooseRandom", "[", 
                    RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"-", "9"}], ",", 
                    RowBox[{"9", "-", "iii"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "iii"}]}], "}"}]}], "]"}], ",", "1"}], "]"}],
                    ",", 
                   RowBox[{"ChooseRandom", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "iii"}]}], "}"}], ",", "1"}], "]"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"aaa", ",", "ddd"}], "}"}], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                   RowBox[{"RandomInteger", "[", "]"}]}], 
                  RowBox[{"{", 
                   RowBox[{"t", ",", 
                    RowBox[{"t", "+", "iii"}]}], "}"}]}]}], ";"}], ",", 
               RowBox[{"evtype", "\[Equal]", "3"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"aaa", ",", "bbb", ",", "ccc"}], "}"}], "=", 
                 RowBox[{"ChooseRandom", "[", 
                  RowBox[{
                   RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "7"}], "]"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "]"}], ",", "3"}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"ddd", "=", 
                 RowBox[{"aaa", "+", 
                  RowBox[{
                   RowBox[{"Sign", "[", "aaa", "]"}], " ", 
                   RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "5"}], "}"}], "]"}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"bbb", " ", "ccc"}], ">", "0"}], ",", 
                  RowBox[{"bbb", "=", 
                   RowBox[{"-", "bbb"}]}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"diag0", ">", "0"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"RandomInteger", "[", "]"}], "\[Equal]", "0"}], 
                    ",", 
                    RowBox[{"aaa", "=", "0"}], ",", 
                    RowBox[{"ddd", "=", "0"}]}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"While", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"t", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"aaa", "-", "ddd"}], ")"}], "^", "2"}], "+", 
                    RowBox[{"4", " ", "bbb", " ", "ccc"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"t", "\[GreaterEqual]", "0"}], "||", 
                    RowBox[{"IntegerQ", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "t"}], "]"}], "]"}]}]}], ",", 
                  RowBox[{"bbb", "=", 
                   RowBox[{"bbb", "+", 
                    RowBox[{"Sign", "[", "bbb", "]"}]}]}]}], "]"}], ";"}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"mtx", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"aaa", ",", "bbb"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"ccc", ",", "ddd"}], "}"}]}], "}"}]}], ";"}]}], 
           "]"}], ";"}], 
         RowBox[{"(*", 
          RowBox[{"end", " ", "coredim", " ", "2"}], "*)"}], 
         RowBox[{"(*", 
          RowBox[{"need", " ", "coredim", " ", "3"}], "*)"}], ",", 
         RowBox[{"(*", 
          RowBox[{"else", " ", "not", " ", "just", " ", "core"}], "*)"}], 
         RowBox[{
          RowBox[{"mtx", "=", 
           RowBox[{"{", 
            RowBox[{"{", "}"}], "}"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "mtx"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "EigenMatrix", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"CoreData", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ",", 
      RowBox[{"ReturnType", "\[Rule]", "0"}], ",", 
      RowBox[{"ComboData", "\[Rule]", "0"}]}], "}"}]}], ";"}], "\n", 
  RowBox[{
  "(*", "*************************************************)"}]}], "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eigenMatrix", "[", 
     RowBox[{"dim_", ",", "entrySize_"}], "]"}], ":=", 
    RowBox[{"eigenMatrix", "[", 
     RowBox[{"dim", ",", "entrySize", ",", "False"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eigenMatrix", "[", 
     RowBox[{"dim_", ",", "entrySize_", ",", "makeTwoTheSame_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"A", ",", "evecs", ",", "s", ",", 
        RowBox[{"test", "=", "True"}], ",", "evs", ",", "notevs"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"evs", ",", "notevs"}], "}"}], "=", 
        RowBox[{"ChooseRandom", "[", 
         RowBox[{
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "entrySize"}], "-", "1"}], ",", 
              RowBox[{"entrySize", "+", "1"}]}], "]"}], ",", 
            RowBox[{"{", "0", "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "dim", "}"}], ",", 
            RowBox[{"{", "3", "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"makeTwoTheSame", ",", 
         RowBox[{
          RowBox[{"evs", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "=", 
          RowBox[{"evs", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{"test", ",", 
         RowBox[{
          RowBox[{"s", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"s", "\[Equal]", "0"}], ",", 
            RowBox[{
             RowBox[{"evecs", "=", 
              RowBox[{"ChooseRandom", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"-", "entrySize"}], ",", "entrySize"}], "]"}], ",", 
                
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", "dim", "}"}], ",", 
                  RowBox[{"{", "dim", "}"}]}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"s", "=", 
              RowBox[{"Det", "[", "evecs", "]"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"evecs", ".", 
            RowBox[{"DiagonalMatrix", "[", "evs", "]"}], ".", 
            RowBox[{"Inverse", "[", "evecs", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"test", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", ">", "3"}], "||", 
             RowBox[{"s", "<", 
              RowBox[{"-", "3"}]}], "||", 
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", "A", "]"}], ",", "0"}], "]"}], 
              "\[GreaterEqual]", "dim"}]}], ")"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"evs", ",", "notevs", ",", "evecs", ",", "A"}], "}"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"findquadratic", " ", 
      RowBox[{"utility", ".", "options"}], " ", "NrRealRoots"}], "\[Rule]", 
     RowBox[{"0", " ", "or", " ", "1", " ", "or", " ", "2"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Monic", "\[Rule]", 
     RowBox[{
     "True", " ", "or", " ", "False", " ", "or", " ", "omit", " ", "for", " ",
       "random"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"RationalRoots", "\[Rule]", 
     RowBox[{
     "True", " ", "or", " ", "False", " ", "or", " ", "omit", " ", "for", " ",
       "random"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"OnlyOneDigit", "\[Rule]", 
     RowBox[{"True", " ", "or", " ", "False", " ", 
      RowBox[{"(", 
       RowBox[{
       "if", " ", "False", " ", "coeffs", " ", "may", " ", "go", " ", "up", 
        " ", "to", " ", "16"}], ")"}], " ", "versiondate", " ", 
      RowBox[{"{", 
       RowBox[{"2003", ",", "12", ",", "31"}], "}"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindQuadratic", "[", "opts___", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "monic", ",", "nrrts", ",", "ratl", ",", "onedig", ",", "skewrts", ",",
         "data", ",", "trans", ",", "pl", ",", "temp", ",", "par", ",", "a", 
        ",", "b", ",", "c", ",", "r"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"extract", " ", "option", " ", "info"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "monic", ",", "nrrts", ",", "ratl", ",", "onedig", ",", "skewrts"}], 
         "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<Monic\>\"", ",", "\"\<NrRealRoots\>\"", ",", 
            "\"\<RationalRoots\>\"", ",", "\"\<OnlyOneDigit\>\"", ",", 
            "\"\<SkewRoots\>\""}], "}"}], "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "FindQuadratic", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"resolve", " ", "uncertainties"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ratl", "=", 
        RowBox[{"If", "[", 
         RowBox[{"ratl", ",", "ratl", ",", "ratl", ",", 
          RowBox[{
           RowBox[{"RandomInteger", "[", "]"}], "\[Equal]", "0"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"monic", "=", 
        RowBox[{"If", "[", 
         RowBox[{"monic", ",", "monic", ",", "monic", ",", 
          RowBox[{
           RowBox[{"RandomInteger", "[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"nrrts", "===", "1"}], ",", "1", ",", "3"}], "]"}], 
            "]"}], "\[Equal]", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"onedig", "=", 
        RowBox[{"If", "[", 
         RowBox[{"onedig", ",", "onedig", ",", "onedig", ",", "False"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"ratl", ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", "skewrts"}], 
              "]"}]}], ",", 
            RowBox[{"skewrts", "=", "3"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"skewrts", "\[Equal]", "0"}], ",", 
            RowBox[{"nrrts", "=", "2"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", "nrrts"}], 
                "]"}]}], ",", 
              RowBox[{"nrrts", "=", 
               RowBox[{"2", " ", 
                RowBox[{"RandomInteger", "[", "]"}]}]}]}], "]"}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"bifurcate", " ", "nrrts"}], "\[Equal]", "2"}], "*)"}], 
          RowBox[{"nrrts", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"nrrts", "\[Equal]", "2"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"skewrts", "\[Equal]", "2"}], "&&", 
                 RowBox[{
                  RowBox[{"RandomInteger", "[", "2", "]"}], "\[Equal]", 
                  "0"}]}], "||", 
                RowBox[{
                 RowBox[{"skewrts", "\[Equal]", "1"}], "&&", 
                 RowBox[{
                  RowBox[{"RandomInteger", "[", "3", "]"}], "\[Equal]", 
                  "0"}]}]}], ")"}]}], ",", "3", ",", "nrrts"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"data", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"2", ",", "4", ",", "1", ",", "5"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", "6", ",", "1", ",", "10"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "6", ",", "1", ",", "13"}], "}"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"4", ",", "8", ",", "4", ",", "5"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", "6", ",", "2", ",", "5"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"6", ",", "8", ",", "5", ",", "5"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", "10", ",", "2", ",", "13"}], "}"}]}], 
                 "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "4", ",", "1", ",", "4"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"6", ",", "6", ",", "1", ",", "9"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"8", ",", "8", ",", "1", ",", "16"}], "}"}]}], 
                "}"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "5", ",", "1", ",", "6"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "6", ",", "1", ",", "5"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", "4", ",", "1", ",", "3"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", "6", ",", "1", ",", "8"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "3", ",", "1", ",", "2"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "5", ",", "1", ",", "4"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "7", ",", "1", ",", "10"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"5", ",", "9", ",", "1", ",", "14"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", "8", ",", "1", ",", "15"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "7", ",", "1", ",", "12"}], "}"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "5", ",", "2", ",", "3"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", "8", ",", "3", ",", "5"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "8", ",", "3", ",", "4"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "7", ",", "2", ",", "6"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "7", ",", "3", ",", "4"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "5", ",", "2", ",", "2"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "7", ",", "2", ",", "5"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "9", ",", "2", ",", "9"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "9", ",", "3", ",", "6"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"5", ",", "9", ",", "2", ",", "7"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "10", ",", "3", ",", "7"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "9", ",", "2", ",", "10"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", "10", ",", "3", ",", "8"}], "}"}]}], 
                 "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"5", ",", "7", ",", "1", ",", "6"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"6", ",", "8", ",", "1", ",", "7"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"7", ",", "9", ",", "1", ",", "8"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"8", ",", "10", ",", "1", ",", "9"}], "}"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"5", ",", "7", ",", "2", ",", "3"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"7", ",", "9", ",", "2", ",", "4"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"8", ",", "10", ",", "3", ",", "3"}], "}"}]}], 
                 "}"}]}], "}"}]}], "}"}], "[", 
            RowBox[{"[", 
             RowBox[{"nrrts", "+", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"trans", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "4"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"3", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"6", ",", "10"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"10", ",", "13"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"3", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "3"}], "}"}]}], "}"}]}], "}"}], "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"nrrts", "+", "1"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{"onedig", ",", "1", ",", "2"}], "]"}]}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"trans", "=", 
           RowBox[{"trans", "-", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"nrrts", "\[Equal]", "2"}], "&&", 
                 RowBox[{"skewrts", "<", "3"}]}], ",", "1", ",", "0"}], "]"}],
               ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"nrrts", "\[Equal]", "2"}], "&&", 
                 RowBox[{"skewrts", "\[Equal]", "2"}]}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{"onedig", ",", "1", ",", "2"}], "]"}], ",", "0"}], 
               "]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"monic", ",", 
            RowBox[{
             RowBox[{"pl", "=", 
              RowBox[{"RandomInteger", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"trans", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"pl", "=", 
              RowBox[{"pl", "+", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"nrrts", "\[Equal]", "2"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"skewrts", "\[Equal]", "2"}], "||", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"skewrts", "\[Equal]", "0"}], "&&", 
                    RowBox[{"pl", ">", "1"}]}], ")"}]}], ")"}]}], ",", "1", 
                 ",", "0"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"temp", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "pl"}], "]"}], "]"}], ",", "0"}], "}"}]}],
              ";"}], ",", 
            RowBox[{"(*", 
             RowBox[{"else", " ", "not", " ", "monic"}], "*)"}], 
            RowBox[{
             RowBox[{"pl", "=", 
              RowBox[{"RandomInteger", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{
                  RowBox[{"trans", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "+", 
                  RowBox[{"2", " ", 
                   RowBox[{"trans", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}], "]"}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"temp", "=", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"pl", "\[LessEqual]", 
                 RowBox[{"trans", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"data", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"pl", "+", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"nrrts", "\[Equal]", "2"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"skewrts", "\[Equal]", "2"}], "||", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"skewrts", "\[Equal]", "0"}], "&&", 
                    RowBox[{"pl", ">", "1"}]}], ")"}]}], ")"}]}], ",", "1", 
                    ",", "0"}], "]"}]}]}], "]"}], "]"}], ",", "1"}], "}"}], 
                ",", 
                RowBox[{"pl", "\[LessEqual]", 
                 RowBox[{
                  RowBox[{"trans", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "+", 
                  RowBox[{"trans", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"data", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"pl", "-", 
                    RowBox[{"trans", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"nrrts", "\[Equal]", "2"}], "&&", 
                    RowBox[{"skewrts", "\[Equal]", "2"}]}], ",", "1", ",", 
                    "0"}], "]"}]}]}], "]"}], "]"}], ",", "0"}], "}"}], ",", 
                "True", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"data", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"pl", "-", 
                    RowBox[{"trans", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"trans", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"nrrts", "\[Equal]", "2"}], "&&", 
                    RowBox[{"skewrts", "\[Equal]", "2"}]}], ",", "1", ",", 
                    "0"}], "]"}]}]}], "]"}], "]"}], ",", "1"}], "}"}]}], 
               "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"par", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"nrrts", "\[Equal]", "2"}], "&&", 
              RowBox[{"skewrts", "\[Equal]", "0"}]}], ",", "1", ",", 
             RowBox[{
              RowBox[{"nrrts", "\[Equal]", "2"}], "&&", 
              RowBox[{"skewrts", "\[Equal]", "2"}]}], ",", "2", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"temp", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
               RowBox[{"{", 
                RowBox[{"4", ",", "8", ",", "4", ",", "5"}], "}"}]}], "||", 
              RowBox[{
               RowBox[{"temp", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "4", ",", "1", ",", "5"}], "}"}]}]}], ",", 
             "1", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"temp", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
               RowBox[{"{", 
                RowBox[{"5", ",", "7", ",", "2", ",", "3"}], "}"}]}], "||", 
              RowBox[{
               RowBox[{"temp", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
               RowBox[{"{", 
                RowBox[{"5", ",", "7", ",", "1", ",", "6"}], "}"}]}]}], ",", 
             "2", ",", "True", ",", 
             RowBox[{"1", "+", 
              RowBox[{"RandomInteger", "[", "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"b", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"RandomInteger", "[", "]"}]}], " ", 
            RowBox[{"temp", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "par"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "r"}], "}"}], "=", 
           RowBox[{"temp", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"temp", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"c", "=", 
           RowBox[{"r", "*", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nrrts", ">", "1"}], "&&", 
               RowBox[{"par", "\[Equal]", "1"}]}], ",", 
              RowBox[{"-", "1"}], ",", "1"}], "]"}]}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", "ratl", "]"}], ",", 
         RowBox[{"(*", 
          RowBox[{"else", " ", "not", " ", "ratl"}], "*)"}], 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", "nrrts"}], 
              "]"}]}], ",", 
            RowBox[{"nrrts", "=", 
             RowBox[{"2", " ", 
              RowBox[{"RandomInteger", "[", "]"}]}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nrrts", "\[Equal]", "0"}], ",", 
            RowBox[{"skewrts", "=", "2"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", "skewrts"}], 
                "]"}]}], ",", 
              RowBox[{"skewrts", "=", 
               RowBox[{"2", 
                RowBox[{"RandomInteger", "[", "]"}]}]}]}], "]"}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "r"}], "}"}], "=", 
           RowBox[{"FindQuadratic", "[", 
            RowBox[{
             RowBox[{"\"\<RationalRoots\>\"", "\[Rule]", "True"}], ",", 
             RowBox[{"\"\<NrRealRoots\>\"", "\[Rule]", "skewrts"}], ",", 
             RowBox[{"\"\<SkewRoots\>\"", "\[Rule]", "nrrts"}], ",", 
             RowBox[{"\"\<Monic\>\"", "\[Rule]", "monic"}], ",", 
             RowBox[{"\"\<OnlyOneDigit\>\"", "\[Rule]", "onedig"}]}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"c", "=", 
           RowBox[{
            RowBox[{"-", "1"}], "*", "r"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c"}], "}"}], "/", 
        RowBox[{"GCD", "[", 
         RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "FindQuadratic", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<Monic\>\"", "\[Rule]", "Maybe"}], ",", 
      RowBox[{"\"\<NrRealRoots\>\"", "\[Rule]", "\"\<Unspecified\>\""}], ",", 
      
      RowBox[{"\"\<RationalRoots\>\"", "\[Rule]", "Maybe"}], ",", 
      RowBox[{"\"\<OnlyOneDigit\>\"", "\[Rule]", "False"}], ",", 
      RowBox[{"\"\<SkewRoots\>\"", "\[Rule]", "\"\<Unspecified\>\""}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "XML", " ", "generating", " ", "utilities", "\[IndentingNewLine]", 
     "accepts", " ", "specially", " ", "formatted", " ", "data", " ", 
     RowBox[{"structure", ":", "\[IndentingNewLine]", "data"}]}], " ", "=", 
    " ", 
    RowBox[{
     RowBox[{"String", " ", "|", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"item", ",", 
         RowBox[{"{", 
          RowBox[{"data", ",", "data", ",", "..."}], "}"}]}], "}"}], 
       "\[IndentingNewLine]", "item"}]}], " ", "=", " ", 
     RowBox[{"String", " ", "|", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nodeName", ",", 
         RowBox[{"{", 
          RowBox[{"attrName", ",", "attrValue"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"attrName", ",", "attrValue"}], "}"}], ",", "..."}], "}"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", " ", "Usage", 
       "\[IndentingNewLine]", 
       RowBox[{"makeXMLDocument", "[", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<root\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<id\>\"", ",", "\"\<none\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<class\>\"", ",", "\"\<none\>\""}], "}"}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<item\>\"", ",", "\[IndentingNewLine]", "\"\<text\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<item\>\"", ",", "\[IndentingNewLine]", "\"\<text\>\""}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<item\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<special\>\"", ",", "\"\<yes\>\""}], "}"}]}], 
               "}"}], ",", "\[IndentingNewLine]", "\"\<Special text\>\""}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<item\>\"", ",", "\[IndentingNewLine]", "\"\<text\>\""}], 
             "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<item\>\"", ",", 
            RowBox[{"{", "\"\<item\>\"", "}"}]}], "}"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeXMLDocument", "[", "data_List", "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<<?xml version='1.0' encoding='UTF-8'?>\>\"", ",", 
     RowBox[{"makeXMLNode", "[", "data", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeXMLNode", "[", "node_List", "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "node", "]"}], "\[Equal]", "1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<<\>\"", ",", 
       RowBox[{"openXMLNode", "[", 
        RowBox[{"node", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\"\</>\\n\>\""}], "]"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<\\n<\>\"", ",", 
       RowBox[{"openXMLNode", "[", 
        RowBox[{"node", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\"\<>\>\"", ",", 
       RowBox[{"StringJoin", "@@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"makeXMLNode", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"Drop", "[", 
           RowBox[{"node", ",", "1"}], "]"}]}], "]"}]}], ",", "\"\<</\>\"", 
       ",", 
       RowBox[{"closeXMLNode", "[", 
        RowBox[{"node", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\"\<>\>\""}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeXMLNode", "[", "text_String", "]"}], ":=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ExportString", "[", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<t\>\"", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "text", "}"}]}], "]"}], ",", "\"\<XML\>\"", ",", 
       RowBox[{"\"\<Entities\>\"", "->", "\"\<HTML\>\""}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"StartOfString", "~~", "\"\<<t>\>\""}], "\[Rule]", 
        "\"\<\>\""}], ",", 
       RowBox[{
        RowBox[{"\"\<</t>\>\"", "~~", "EndOfString"}], "\[Rule]", 
        "\"\<\>\""}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"openXMLNode", "[", "name_String", "]"}], ":=", 
  "name"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"closeXMLNode", "[", "name_String", "]"}], ":=", "name"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"openXMLNode", "[", "list_List", "]"}], ":=", 
  RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ToString", "[", 
     RowBox[{"list", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"makeXMLAttributes", "[", 
     RowBox[{"Drop", "[", 
      RowBox[{"list", ",", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"closeXMLNode", "[", "list_List", "]"}], ":=", 
   RowBox[{"ToString", "[", 
    RowBox[{"list", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeXMLAttribute", "[", "attr_List", "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"\"\< \>\"", ",", 
    RowBox[{"ToString", "[", 
     RowBox[{"attr", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\"\<='\>\"", ",", 
    RowBox[{"ToString", "[", 
     RowBox[{"attr", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "\"\<'\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeXMLAttributes", "[", "attrs_List", "]"}], ":=", 
   RowBox[{"Apply", "[", 
    RowBox[{"StringJoin", ",", 
     RowBox[{"Map", "[", 
      RowBox[{"makeXMLAttribute", ",", "attrs", ",", 
       RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"end", " ", "of", " ", "XML", " ", "utilities"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"HTML", " ", "utilities"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Wraps", " ", "LaTeX", " ", "for", " ", "MathJax", " ", "rendering"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"htmlLatex", "=", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "\"\<<script type='math/tex'>\>\"", ",", "#", ",", 
       "\"\<</script>\>\""}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Wraps", " ", "LaTeX", " ", "for", " ", "MathJax", " ", "rendering", " ", 
    "in", " ", "display", " ", "mode"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"htmlLatexDisplay", "=", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "\"\<<script type='math/tex; mode=display'>\>\"", ",", "#", ",", 
       "\"\<</script>\>\""}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Wrap", " ", "the", " ", "text", " ", "in", " ", "appropriate", " ", 
    "HTML", " ", "tags", " ", "to", " ", "be", " ", "displayed", " ", "as", 
    " ", "a", " ", "problem", " ", "prompt"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "htmlPrompt", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"promptId", "\[Rule]", "\"\<\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"htmlPrompt", ",", 
     RowBox[{"promptId", "\[Rule]", "\"\<\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"htmlPrompt", " ", "[", 
    RowBox[{"title_String", ",", "body_String", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
    "\"\<<div><h2>\>\"", "<>", "title", "<>", 
     "\"\<</h2></div><div promptId='\>\"", "<>", 
     RowBox[{"OptionValue", "[", "promptId", "]"}], "<>", "\"\<'><p>\>\"", "<>",
      "body", "<>", "\"\<</p></div>\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"htmlPrompt", " ", "[", 
     RowBox[{"body_String", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<<div promptId='\>\"", "<>", 
      RowBox[{"OptionValue", "[", "promptId", "]"}], "<>", "\"\<'><p>\>\"", "<>",
       "body", "<>", "\"\<</p></div>\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Generate", " ", "an", " ", "input", " ", "field"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"htmlInputField", " ", "[", 
    RowBox[{"fieldId_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{
   "\"\<<span class='inputfield' style='font-size: 100%; font-family: \
STIXGeneral-Regular; ' contenteditable='true' fieldId = '\>\"", "<>", 
    "fieldId", "<>", "\"\<'></span>\>\""}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Set", " ", "default", " ", "options", " ", "for", " ", "htmlInputField"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "htmlInputField", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Enabled", "\[Rule]", "True"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"htmlInputField", ",", 
     RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Put", " ", "all", " ", "input", " ", "fields", " ", "together", " ", 
    "and", " ", "supply", " ", "them", " ", "with", " ", 
    RowBox[{"a", " ", "'"}], 
    RowBox[{"Submit", "'"}], " ", "button"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"htmlInputFieldBuilder", " ", "[", " ", 
    RowBox[{"problemId_", ",", "prompt_", ",", " ", "fields_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
    "\"\<<div promptId = '\>\"", ",", "problemId", ",", 
     "\"\<' class='inputbox'>\>\"", ",", "prompt", ",", "\"\<&nbsp;\>\"", ",", 
     RowBox[{"fields", "<>", "\"\<&nbsp;<input promptId = '\>\""}], ",", 
     "problemId", ",", 
     "\"\<' class='evalButton' type='button' value='Submit'\>\"", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "Enabled", "]"}], ",", "\"\<\>\"", ",", 
       "\"\< disabled='true'\>\""}], "]"}], ",", 
     "\"\< />&nbsp;<span id='resultsField\>\"", ",", "problemId", ",", 
     "\"\<'></span></div>\>\""}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Set", " ", "default", " ", "options", " ", "for", " ", 
    "htmlInputFieldBuilder"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "htmlInputFieldBuilder", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Enabled", "\[Rule]", "True"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"htmlInputFieldBuilder", ",", 
     RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"end", " ", "of", " ", "HTML", " ", "utilities"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Set", " ", "default", " ", "options", " ", "for", " ", "makeproblem"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "makeproblem", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Enabled", "\[Rule]", "True"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"makeproblem", ",", 
    RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"On", "[", 
   RowBox[{"General", "::", "\"\<spell1\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"On", "[", 
   RowBox[{"General", "::", "\"\<spell\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588788788730583*^9, 3.588788839322361*^9}, {
   3.5887890946756763`*^9, 3.588789114902072*^9}, 3.5887891450179243`*^9, {
   3.58878919240965*^9, 3.588789266267112*^9}, 3.588789334846941*^9, {
   3.588789448921554*^9, 3.588789502475102*^9}, {3.5887895849834013`*^9, 
   3.5887895991828957`*^9}, 3.5887897735184803`*^9, {3.588792175824545*^9, 
   3.588792189330944*^9}, {3.588792277277171*^9, 3.588792332330186*^9}, 
   3.5887923631654377`*^9, {3.588792417803377*^9, 3.588792467705484*^9}, {
   3.588792501791564*^9, 3.5887925318884897`*^9}, {3.588792583881175*^9, 
   3.5887925915934677`*^9}, {3.588792674781343*^9, 3.588792704184026*^9}, 
   3.588792764313629*^9, {3.58880617665129*^9, 3.588806194442127*^9}, {
   3.588874991191057*^9, 3.588875283755974*^9}, 3.588875865304079*^9, {
   3.5888759208892813`*^9, 3.588875921357449*^9}}]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1303, 738},
WindowMargins->{{11, Automatic}, {Automatic, 44}},
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 976, 18, 43, "Input",
 InitializationCell->True],
Cell[1524, 40, 129, 2, 27, "Input"],
Cell[1656, 44, 1056, 19, 58, "Input",
 InitializationCell->True],
Cell[2715, 65, 205389, 5320, 10353, "Input",
 InitializationCell->True]
}
]
*)

(* End of internal cache information *)
